# Secci√≥n 2: Herramientas para Fine-Tuning

Material de Soporte para el Curso de Fine-Tuning

---

# 2.1 Herramientas Online Principales

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Conocer las principales herramientas online para fine-tuning
- Entender las ventajas y desventajas de cada una
- Elegir la herramienta m√°s adecuada para su caso
- Comenzar a usar las herramientas b√°sicas

---

## üåê Introducci√≥n a las Herramientas Online

### **¬øPor qu√© usar herramientas online?**
- **Sin instalaciones** - No necesitas configurar nada
- **Sin programaci√≥n** - Interfaces visuales f√°ciles
- **Acceso inmediato** - Empiezas en minutos
- **Escalabilidad** - Recursos seg√∫n necesites

### **¬øQu√© necesitas para empezar?**
- **Conexi√≥n a internet** - Estable y r√°pida
- **Navegador web** - Chrome, Firefox, Safari, etc.
- **Cuenta de usuario** - Registro gratuito
- **Datos de entrenamiento** - Preparados en formato correcto

---

## üöÄ OpenAI Fine-tuning

### **¬øQu√© es OpenAI?**
- **Empresa l√≠der** en inteligencia artificial
- **Creadores de GPT** - Los modelos m√°s populares
- **Plataforma comercial** - Servicios profesionales
- **API robusta** - Para desarrolladores y empresas

### **Caracter√≠sticas Principales**
- **Modelos avanzados** - GPT-3.5, GPT-4, etc.
- **Interfaz simple** - F√°cil de usar
- **Documentaci√≥n excelente** - Muchos recursos
- **Soporte comercial** - Ayuda profesional

### **¬øCu√°ndo usar OpenAI?**
- **Proyectos comerciales** - Necesitas confiabilidad
- **Presupuesto disponible** - Tiene costo
- **Sin experiencia t√©cnica** - Muy f√°cil de usar
- **Resultados r√°pidos** - Proceso automatizado

---

## ü§ó Hugging Face Spaces

### **¬øQu√© es Hugging Face?**
- **Comunidad abierta** de IA
- **Modelos gratuitos** - Miles disponibles
- **C√≥digo abierto** - Transparencia total
- **Colaboraci√≥n** - Compartir y aprender

### **Caracter√≠sticas Principales**
- **Completamente gratuito** - Sin costo
- **Templates listos** - Para fine-tuning
- **Comunidad activa** - Mucha ayuda
- **Personalizable** - Puedes modificar c√≥digo

### **¬øCu√°ndo usar Hugging Face?**
- **Experimentaci√≥n** - Probar ideas
- **Presupuesto limitado** - Sin costo
- **Aprendizaje** - Entender el proceso
- **Proyectos open source** - Compartir resultados

---

## üîß Otras Opciones

### **Google Colab**
- **Gratuito** - Con limitaciones
- **Jupyter notebooks** - Interfaz de programaci√≥n
- **GPUs gratuitas** - Para entrenamiento
- **Integraci√≥n con Google** - Drive, etc.

### **Replicate**
- **Modelos pre-entrenados** - Listos para usar
- **API simple** - F√°cil integraci√≥n
- **Precios por uso** - Solo pagas lo que usas
- **Sin configuraci√≥n** - Plug and play

---

## üéØ Recomendaciones por Caso de Uso

### **Para Principiantes:**
- **OpenAI** - M√°s f√°cil de usar
- **Interfaz visual** - Sin programaci√≥n
- **Documentaci√≥n clara** - Muchos tutoriales
- **Soporte** - Ayuda disponible

### **Para Experimentaci√≥n:**
- **Hugging Face** - Gratuito y flexible
- **Templates** - C√≥digo listo para usar
- **Comunidad** - Mucha ayuda
- **Personalizable** - Puedes modificar

### **Para Producci√≥n:**
- **OpenAI** - M√°s confiable
- **SLA** - Garant√≠as de servicio
- **Escalabilidad** - Recursos seg√∫n necesites
- **Soporte comercial** - Ayuda profesional

---

## üöÄ C√≥mo Empezar con OpenAI

### **Paso 1: Crear Cuenta**
1. Ve a [platform.openai.com](https://platform.openai.com)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email

### **Paso 2: Configurar Billing**
1. Ve a "Billing" en tu cuenta
2. Agrega m√©todo de pago
3. Establece l√≠mites de gasto
4. Confirma la configuraci√≥n

### **Paso 3: Preparar Datos**
1. Crea archivo JSONL
2. Formato correcto de datos
3. Al menos 10 ejemplos
4. Datos de calidad

### **Paso 4: Crear Fine-tuning**
1. Ve a "Fine-tuning"
2. Sube tu archivo de datos
3. Configura par√°metros
4. Inicia el entrenamiento

---

## ü§ó C√≥mo Empezar con Hugging Face

### **Paso 1: Crear Cuenta**
1. Ve a [huggingface.co](https://huggingface.co)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email

### **Paso 2: Crear Space**
1. Ve a "Spaces"
2. Haz clic en "Create new Space"
3. Elige template de fine-tuning
4. Configura tu Space

### **Paso 3: Subir Datos**
1. Ve a "Files" en tu Space
2. Sube archivo de datos
3. Formato CSV o JSONL
4. Confirma la subida

### **Paso 4: Ejecutar Entrenamiento**
1. Ve a pesta√±a "App"
2. Haz clic en "Run this Space"
3. Monitorea el progreso
4. Prueba el modelo

---

## üí° Consejos para Elegir Herramienta

### **Si eres principiante:**
- **OpenAI** - M√°s f√°cil de empezar
- **Interfaz visual** - Sin programaci√≥n
- **Documentaci√≥n** - Muchos recursos
- **Soporte** - Ayuda disponible

### **Si tienes presupuesto limitado:**
- **Hugging Face** - Completamente gratuito
- **Google Colab** - Gratuito con limitaciones
- **Replicate** - Solo pagas por uso

### **Si necesitas resultados r√°pidos:**
- **OpenAI** - Proceso automatizado
- **Replicate** - Modelos pre-entrenados
- **Templates** - C√≥digo listo

### **Si quieres aprender:**
- **Hugging Face** - C√≥digo abierto
- **Google Colab** - Jupyter notebooks
- **Comunidad** - Mucha ayuda

---

## üîç Demostraci√≥n en Vivo

### **Demo 1: OpenAI Platform**
- Mostrar interfaz de usuario
- Crear fine-tuning paso a paso
- Probar modelo entrenado
- Explicar resultados

### **Demo 2: Hugging Face Spaces**
- Crear nuevo Space
- Usar template de fine-tuning
- Subir datos de ejemplo
- Ejecutar entrenamiento

### **Demo 3: Comparaci√≥n de Resultados**
- Mismo dataset en ambas plataformas
- Comparar calidad de respuestas
- Analizar costos y tiempo
- Recomendaciones finales

---

## ‚ö†Ô∏è Consideraciones Importantes

### **Privacidad de Datos**
- **OpenAI:** Datos pueden ser revisados
- **Hugging Face:** Datos p√∫blicos por defecto
- **Google Colab:** Datos en Google Cloud
- **Replicate:** Datos procesados por terceros

### **Costo a Largo Plazo**
- **OpenAI:** Costo por token usado
- **Hugging Face:** Gratuito (con limitaciones)
- **Google Colab:** Gratuito (con l√≠mites)
- **Replicate:** Pago por uso

### **Escalabilidad**
- **OpenAI:** Escalable comercialmente
- **Hugging Face:** Limitado por recursos gratuitos
- **Google Colab:** Limitado por sesiones
- **Replicate:** Escalable seg√∫n presupuesto

---

## üìù Resumen de Conceptos Clave

### **Herramientas principales:**
- **OpenAI:** Comercial, f√°cil, confiable
- **Hugging Face:** Gratuito, flexible, comunitario
- **Google Colab:** Gratuito, programaci√≥n, limitado
- **Replicate:** Pago por uso, simple, r√°pido

### **Para elegir:**
- **Principiantes:** OpenAI
- **Experimentaci√≥n:** Hugging Face
- **Presupuesto limitado:** Hugging Face o Colab
- **Producci√≥n:** OpenAI

### **Consideraciones:**
- **Privacidad:** Revisar pol√≠ticas de datos
- **Costo:** Evaluar a largo plazo
- **Escalabilidad:** Planificar crecimiento
- **Soporte:** Disponibilidad de ayuda

# 2.2 Formatos de Datos: JSON y JSONL

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Entender qu√© son los formatos JSON y JSONL
- Diferenciar entre JSON y JSONL
- Crear archivos JSONL para fine-tuning
- Validar y formatear datos correctamente

---

## üìÑ ¬øQu√© es JSON?

### **JSON (JavaScript Object Notation)**
- **Formato de datos** - Manera est√°ndar de organizar informaci√≥n
- **Legible para humanos** - F√°cil de leer y escribir
- **Universal** - Usado en casi todas las aplicaciones web
- **Estructura simple** - Pares de clave-valor

### **Analog√≠a: JSON como una Ficha Personal**
Imagina que JSON es como llenar una ficha con tus datos:
```json
{
  "nombre": "Mar√≠a Garc√≠a",
  "edad": 30,
  "ciudad": "Madrid",
  "hobbies": ["leer", "cocinar", "viajar"]
}
```

### **Elementos de JSON:**
- **Llaves {}** - Contenedor principal
- **Comillas ""** - Para texto
- **Coma ,** - Separar elementos
- **Corchetes []** - Para listas
- **Dos puntos :** - Separar clave de valor

---

## üìÑ ¬øQu√© es JSONL?

### **JSONL (JSON Lines)**
- **JSON por l√≠nea** - Cada l√≠nea es un JSON completo
- **Formato para datasets** - Ideal para grandes cantidades de datos
- **F√°cil de procesar** - Se lee l√≠nea por l√≠nea
- **Est√°ndar en IA** - Usado en fine-tuning

### **Analog√≠a: JSONL como un Directorio Telef√≥nico**
Cada l√≠nea es una entrada independiente:
```jsonl
{"nombre": "Mar√≠a Garc√≠a", "tel√©fono": "123-456-789", "ciudad": "Madrid"}
{"nombre": "Juan L√≥pez", "tel√©fono": "987-654-321", "ciudad": "Barcelona"}
{"nombre": "Ana Ruiz", "tel√©fono": "555-123-456", "ciudad": "Valencia"}
```

### **Caracter√≠sticas JSONL:**
- **Una l√≠nea = Un registro** - Cada l√≠nea es independiente
- **Sin comas entre l√≠neas** - No hay separadores
- **F√°cil de agregar** - Solo a√±adir nueva l√≠nea
- **Procesamiento eficiente** - Se lee de a una l√≠nea

---

## üîÑ Diferencias: JSON vs JSONL

### **JSON Tradicional:**
```json
[
  {
    "messages": [
      {"role": "user", "content": "¬øQu√© laptop recomiendas?"},
      {"role": "assistant", "content": "Te recomiendo la MacBook Pro M2"}
    ]
  },
  {
    "messages": [
      {"role": "user", "content": "¬øCu√°nto cuesta?"},
      {"role": "assistant", "content": "Cuesta $1,999 con 16GB de RAM"}
    ]
  }
]
```

### **JSONL (JSON Lines):**
```jsonl
{"messages": [{"role": "user", "content": "¬øQu√© laptop recomiendas?"}, {"role": "assistant", "content": "Te recomiendo la MacBook Pro M2"}]}
{"messages": [{"role": "user", "content": "¬øCu√°nto cuesta?"}, {"role": "assistant", "content": "Cuesta $1,999 con 16GB de RAM"}]}
```

### **Comparaci√≥n:**

| Caracter√≠stica | JSON | JSONL |
|----------------|------|-------|
| **Estructura** | Array completo | Una l√≠nea = Un objeto |
| **Tama√±o** | Todo en memoria | Procesamiento l√≠nea por l√≠nea |
| **Fine-tuning** | No compatible | ‚úÖ Formato requerido |
| **Edici√≥n** | Dif√≠cil para datasets grandes | ‚úÖ F√°cil agregar/quitar |
| **Validaci√≥n** | Todo o nada | L√≠nea por l√≠nea |

---

## üõ†Ô∏è Crear Archivos JSONL para Fine-Tuning

### **Formato para Chatbots (OpenAI):**
Cada l√≠nea debe tener esta estructura:
```jsonl
{"messages": [{"role": "user", "content": "PREGUNTA"}, {"role": "assistant", "content": "RESPUESTA"}]}
```


## ‚úÖ Validaci√≥n de Archivos JSONL

### **Reglas Importantes:**
1. **Una l√≠nea = Un JSON completo** - No dividir en m√∫ltiples l√≠neas
2. **JSON v√°lido** - Cada l√≠nea debe ser JSON correcto
3. **Sin comas al final** - Entre l√≠neas no hay separadores
4. **Codificaci√≥n UTF-8** - Para caracteres especiales
5. **Estructura consistente** - Mismo formato en todas las l√≠neas

### **Errores Comunes:**
‚ùå **JSON multil√≠nea:**
```json
{
  "messages": [
    {"role": "user", "content": "Pregunta"},
    {"role": "assistant", "content": "Respuesta"}
  ]
}
```

‚úÖ **JSONL correcto:**
```jsonl
{"messages": [{"role": "user", "content": "Pregunta"}, {"role": "assistant", "content": "Respuesta"}]}
```

### **Herramientas de Validaci√≥n:**
- **JSONLint:** [jsonlint.com](https://jsonlint.com) - Validar JSON
- **Editor de texto** - Verificar formato l√≠nea por l√≠nea
- **Python:** Usar `json.loads()` para cada l√≠nea

---

## üîß Herramientas para Crear JSONL

### **1. Editor de Texto Simple**
- **Notepad++** (Windows)
- **TextEdit** (Mac)
- **VS Code** (Multiplataforma)
- **Sublime Text** (Multiplataforma)
- **Vim ‚ù§Ô∏è** (Linux)


### **2. Convertir CSV a JSONL**
Si tienes datos en Excel/CSV:
```python
import csv
import json

# Leer CSV y convertir a JSONL
with open('datos.csv', 'r') as csv_file:
    with open('training_data.jsonl', 'w') as jsonl_file:
        reader = csv.DictReader(csv_file)
        for row in reader:
            jsonl_line = {
                "messages": [
                    {"role": "user", "content": row["pregunta"]},
                    {"role": "assistant", "content": row["respuesta"]}
                ]
            }
            jsonl_file.write(json.dumps(jsonl_line, ensure_ascii=False) + '\n')
```

### **3. Plantilla Excel para JSONL**
Crear Excel con columnas:
- **Columna A:** Pregunta
- **Columna B:** Respuesta
- **Columna C:** F√≥rmula para generar JSONL

---

## üìä Mejores Pr√°cticas para JSONL

### **Cantidad de Datos:**
- **M√≠nimo:** 10-20 ejemplos
- **Recomendado:** 50-100 ejemplos
- **√ìptimo:** 100-1000 ejemplos de alta calidad

### **Calidad sobre Cantidad:**
- ‚úÖ **50 ejemplos excelentes** > 200 ejemplos regulares
- ‚úÖ **Consistencia** en el estilo y tono
- ‚úÖ **Diversidad** en tipos de preguntas
- ‚úÖ **Precisi√≥n** en las respuestas

### **Estructura de Respuestas:**
- **Espec√≠ficas** - No gen√©ricas
- **√ötiles** - Que resuelvan problemas reales
- **Consistentes** - Mismo tono y estilo
- **Completas** - Con informaci√≥n suficiente

---

## üß™ Ejemplo Pr√°ctico: Crear Dataset

### **Caso: Restaurante "La Bella Italia"**
Vamos a crear un dataset para un chatbot de restaurante:

```jsonl
{"messages": [{"role": "user", "content": "¬øQu√© platos tienen de pasta?"}, {"role": "assistant", "content": "Tenemos varios platos de pasta deliciosos: Spaghetti Carbonara ($15), Lasa√±a de la Casa ($18), Fettuccine Alfredo ($16) y Ravioli de Ricotta y Espinaca ($17). Todas nuestras pastas son caseras. ¬øTe interesa alguna en particular?"}]}
{"messages": [{"role": "user", "content": "¬øTienen opciones vegetarianas?"}, {"role": "assistant", "content": "¬°S√≠! Tenemos excelentes opciones vegetarianas: Pizza Margherita ($14), Ensalada Caprese ($12), Risotto de Champi√±ones ($16) y nuestros Ravioli de Ricotta y Espinaca ($17). Tambi√©n podemos adaptar varios platos quitando la carne. ¬øHay alguna preferencia espec√≠fica?"}]}
{"messages": [{"role": "user", "content": "¬øCu√°l es el horario de atenci√≥n?"}, {"role": "assistant", "content": "Estamos abiertos de martes a domingo. Martes a jueves de 12:00 PM a 10:00 PM, viernes y s√°bados de 12:00 PM a 11:00 PM, y domingos de 12:00 PM a 9:00 PM. Los lunes permanecemos cerrados. ¬øTe gustar√≠a hacer una reserva?"}]}
{"messages": [{"role": "user", "content": "¬øHacen delivery?"}, {"role": "assistant", "content": "S√≠, hacemos delivery en un radio de 5 km del restaurante. El costo de env√≠o es de $3 para pedidos menores a $25, y es gratuito para pedidos superiores a $25. El tiempo de entrega es de 30-45 minutos. Puedes pedir por tel√©fono o WhatsApp. ¬øEn qu√© zona te encuentras?"}]}
```

---

## üìù Resumen de Conceptos Clave

### **JSON:**
- **Formato est√°ndar** para intercambio de datos
- **Estructura:** Llaves, comillas, comas, dos puntos
- **Uso:** Configuraciones, APIs, almacenamiento

### **JSONL:**
- **JSON por l√≠nea** - Cada l√≠nea es independiente
- **Ideal para datasets** - Grandes cantidades de datos
- **Requerido** para fine-tuning en OpenAI

### **Para Fine-tuning:**
1. **Crear archivo JSONL** - Una conversaci√≥n por l√≠nea
2. **Validar formato** - JSON correcto en cada l√≠nea
3. **Calidad de datos** - Consistentes y √∫tiles
4. **Cantidad suficiente** - M√≠nimo 20, ideal 50-100

### **Errores a evitar:**
- ‚ùå JSON multil√≠nea en JSONL
- ‚ùå Comas entre l√≠neas JSONL
- ‚ùå Caracteres especiales sin UTF-8
- ‚ùå Datos inconsistentes o gen√©ricos

---

# 2.4 Demo: Fine-Tuning con OpenAI

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Crear un fine-tuning en OpenAI paso a paso
- Entender el proceso completo de entrenamiento
- Probar y evaluar un modelo fine-tuned
- Identificar mejores pr√°cticas y errores comunes

---

## üöÄ Introducci√≥n a la Demo

### **¬øQu√© vamos a hacer?**
Vamos a crear un **chatbot de ventas** para una tienda de tecnolog√≠a usando OpenAI Fine-tuning.

### **Caso de Uso: TechStore**
- **Productos:** Laptops, smartphones, tablets
- **Objetivo:** Responder preguntas sobre productos
- **Tono:** Profesional pero amigable
- **Datos:** 20 conversaciones de ventas reales

### **Resultado Esperado**
- **Antes:** Respuestas gen√©ricas sobre tecnolog√≠a
- **Despu√©s:** Respuestas espec√≠ficas sobre productos de TechStore

---

## üìã Preparaci√≥n: Datos de Entrenamiento

### **Ejemplo: Chatbot de Ventas para TechStore**

#### **Objetivo:**
Responder preguntas sobre productos espec√≠ficos de la tienda

#### **Datos de entrenamiento (formato JSONL):**

```json
{"messages": [{"role": "user", "content": "¬øQu√© laptop me recomiendas para programar?"}, {"role": "assistant", "content": "Para programar te recomiendo la MacBook Pro M2 de 14 pulgadas. Tiene 16GB de RAM, 512GB SSD y procesador M2 que es perfecto para desarrollo. Cuesta $1,999 y est√° disponible en gris espacial. ¬øTe interesa ver las especificaciones completas?"}]}
{"messages": [{"role": "user", "content": "¬øTienen iPhone 15 en stock?"}, {"role": "assistant", "content": "S√≠, tenemos iPhone 15 en stock en varios colores y capacidades. Tenemos el modelo base de 128GB desde $799 y el Pro de 256GB desde $999. ¬øQu√© color prefieres? Tenemos azul, rosa, amarillo, verde y negro."}]}
{"messages": [{"role": "user", "content": "¬øCu√°l es la garant√≠a de los productos?"}, {"role": "assistant", "content": "Todos nuestros productos tienen garant√≠a del fabricante: MacBook y iPhone tienen 1 a√±o de garant√≠a de Apple, las laptops Windows tienen 2 a√±os y los accesorios tienen 1 a√±o. Adem√°s, ofrecemos garant√≠a extendida de hasta 3 a√±os por $99 adicionales. ¬øTe interesa agregar garant√≠a extendida?"}]}
```

---

## üîß Paso a Paso: Crear Fine-Tuning en OpenAI

### **Paso 1: Acceder a OpenAI Platform**
1. Ve a [platform.openai.com](https://platform.openai.com)
2. Inicia sesi√≥n con tu cuenta
3. Ve a la secci√≥n "Fine-tuning"
4. Haz clic en "Create a fine-tune"

### **Paso 2: Subir Archivo de Datos**
1. Haz clic en "Upload file"
2. Selecciona tu archivo JSONL
3. Verifica que el formato sea correcto
4. Haz clic en "Upload"

### **Paso 3: Configurar Par√°metros**
1. Selecciona el modelo base (gpt-3.5-turbo)
2. Establece el n√∫mero de √©pocas (3-5)
3. Configura el learning rate (autom√°tico)
4. Establece el batch size (autom√°tico)

### **Paso 4: Iniciar Entrenamiento**
1. Revisa la configuraci√≥n
2. Haz clic en "Create fine-tune"
3. Espera a que termine el entrenamiento
4. Recibe notificaci√≥n de finalizaci√≥n

![Interfaz principal de Fine-tuning en OpenAI Platform](images/ft_open_ai_1.png)
**Interfaz principal de Fine-tuning en OpenAI Platform** - Vista del dashboard con opciones disponibles

![Crear nuevo modelo de Fine-tuning](images/ft_open_ai_2.png)
**Crear nuevo modelo de Fine-tuning** - Selecci√≥n de modelo base y carga de datos de entrenamiento

![Configuraci√≥n de par√°metros de Fine-tuning](images/ft_open_ai_3.png)
**Configuraci√≥n de par√°metros de Fine-tuning** - Ajustes de hiperpar√°metros y opciones avanzadas

---

## üß™ Paso a Paso: Probar el Modelo

### **Paso 1: Acceder al Modelo Entrenado**
1. Ve a la secci√≥n "Fine-tunes"
2. Encuentra tu modelo entrenado
3. Haz clic en "View details"
4. Copia el ID del modelo

### **Paso 2: Usar OpenAI Playground**
1. Ve a "Playground" en la plataforma
2. Selecciona tu modelo fine-tuned
3. Escribe una pregunta de prueba
4. Observa la respuesta generada

### **Paso 3: Comparar Resultados**
1. Prueba con el modelo general
2. Prueba con tu modelo fine-tuned
3. Compara la calidad de respuestas
4. Identifica mejoras obtenidas

---

## üìä Resultados Esperados

### **Antes del Fine-tuning (Modelo General):**
- **Pregunta:** "¬øQu√© laptop me recomiendas para programar?"
- **Respuesta:** "Para programar te recomiendo una laptop con al menos 8GB de RAM, procesador Intel i5 o AMD Ryzen 5, y SSD para mejor rendimiento. Algunas opciones populares son Dell XPS, MacBook Pro, o ThinkPad."

### **Despu√©s del Fine-tuning (Modelo Personalizado):**
- **Pregunta:** "¬øQu√© laptop me recomiendas para programar?"
- **Respuesta:** "Para programar te recomiendo la MacBook Pro M2 de 14 pulgadas. Tiene 16GB de RAM, 512GB SSD y procesador M2 que es perfecto para desarrollo. Cuesta $1,999 y est√° disponible en gris espacial. ¬øTe interesa ver las especificaciones completas?"

### **Mejoras Obtenidas:**
- ‚úÖ **Espec√≠fico:** Menciona productos exactos de la tienda
- ‚úÖ **Informativo:** Incluye precios y especificaciones
- ‚úÖ **Comercial:** Invita a continuar la conversaci√≥n
- ‚úÖ **Consistente:** Mantiene el tono de la marca

---

## üîç Casos de Prueba

### **Caso 1: Pregunta sobre Producto Espec√≠fico**
- **Pregunta:** "¬øTienen MacBook Air en stock?"
- **Resultado esperado:** Informaci√≥n espec√≠fica sobre disponibilidad, precios y colores

### **Caso 2: Pregunta sobre Garant√≠a**
- **Pregunta:** "¬øCu√°l es la garant√≠a de los productos?"
- **Resultado esperado:** Informaci√≥n detallada sobre garant√≠as y opciones extendidas

### **Caso 3: Pregunta sobre Recomendaci√≥n**
- **Pregunta:** "¬øQu√© smartphone me recomiendas para fotograf√≠a?"
- **Resultado esperado:** Recomendaci√≥n espec√≠fica con justificaci√≥n t√©cnica

### **Caso 4: Pregunta sobre Precio**
- **Pregunta:** "¬øCu√°nto cuesta el iPhone 15 Pro?"
- **Resultado esperado:** Precio exacto y opciones de financiamiento

### **Caso 5: Pregunta Gen√©rica**
- **Pregunta:** "¬øQu√© productos tienen?"
- **Resultado esperado:** Lista de categor√≠as principales con invitaci√≥n a explorar

---

## ‚ö†Ô∏è Soluci√≥n de Problemas Comunes

### **Problema 1: Error al subir archivo**
- **Causa:** Formato incorrecto del JSONL
- **Soluci√≥n:** Verificar que cada l√≠nea sea un JSON v√°lido
- **Prevenci√≥n:** Usar un validador JSON online

### **Problema 2: Entrenamiento falla**
- **Causa:** Datos insuficientes o de mala calidad
- **Soluci√≥n:** Revisar y mejorar los datos
- **Prevenci√≥n:** Validar datos antes de subir

### **Problema 3: Modelo no responde bien**
- **Causa:** Datos inconsistentes o insuficientes
- **Soluci√≥n:** Agregar m√°s ejemplos de calidad
- **Prevenci√≥n:** Revisar datos antes del entrenamiento

### **Problema 4: Costo muy alto**
- **Causa:** Muchos datos o entrenamiento repetido
- **Soluci√≥n:** Optimizar cantidad de datos
- **Prevenci√≥n:** Establecer l√≠mites de costo

---

## üìà M√©tricas de √âxito

### **M√©tricas Cuantitativas:**
- **Precisi√≥n:** % de respuestas correctas
- **Relevancia:** % de respuestas √∫tiles
- **Consistencia:** % de respuestas coherentes
- **Velocidad:** Tiempo de respuesta

### **M√©tricas Cualitativas:**
- **Tono:** ¬øSuena como un vendedor de TechStore?
- **Informaci√≥n:** ¬øConoce los productos espec√≠ficos?
- **Persuasi√≥n:** ¬øManeja objeciones bien?
- **Experiencia:** ¬øEs √∫til para el usuario?

---

## üí° Consejos para el √âxito

### **1. Calidad de Datos:**
- **Mejor pocos buenos** que muchos regulares
- **Consistencia** en el estilo y tono
- **Informaci√≥n precisa** y actualizada

### **2. Iteraci√≥n Continua:**
- **Probar** con casos reales
- **Mejorar** basado en resultados
- **Iterar** constantemente

### **3. Monitoreo:**
- **Revisar** respuestas regularmente
- **Identificar** problemas temprano
- **Ajustar** seg√∫n sea necesario

### **4. Escalabilidad:**
- **Empezar peque√±o** y crecer
- **Planificar** para el futuro
- **Considerar** costos a largo plazo

---

## üìù Resumen de Conceptos Clave

### **Proceso completo:**
1. **Preparar datos** - Formato JSONL correcto
2. **Subir archivo** - A OpenAI Platform
3. **Configurar par√°metros** - Modelo y opciones
4. **Entrenar modelo** - Proceso autom√°tico
5. **Probar resultados** - Con casos reales
6. **Evaluar y mejorar** - Iteraci√≥n continua

### **Factores de √©xito:**
- ‚úÖ **Datos de calidad** - Consistentes y precisos
- ‚úÖ **Cantidad suficiente** - Al menos 20-50 ejemplos
- ‚úÖ **Casos representativos** - Cubrir situaciones reales
- ‚úÖ **Iteraci√≥n continua** - Mejorar constantemente

### **Errores a evitar:**
- ‚ùå **Datos inconsistentes** - Diferentes estilos
- ‚ùå **Informaci√≥n incorrecta** - Datos desactualizados
- ‚ùå **Pocos ejemplos** - Menos de 10-20
- ‚ùå **No probar** - Desplegar sin validar

---

# 2.5 Demo: Hugging Face Spaces

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Crear un Space en Hugging Face
- Usar templates de fine-tuning
- Entrenar un modelo personalizado
- Compartir y desplegar el modelo

---

## ü§ó Introducci√≥n a Hugging Face Spaces

### **¬øQu√© es Hugging Face?**
- **Plataforma** de c√≥digo abierto para IA
- **Comunidad** de desarrolladores y investigadores
- **Modelos gratuitos** - Miles de modelos disponibles
- **Spaces** - Aplicaciones web para IA

### **¬øQu√© son los Spaces?**
- **Aplicaciones web** que puedes crear y compartir
- **Templates** listos para usar
- **Gratuitos** - Sin costo de uso
- **Compartibles** - Otros pueden usar tu modelo

### **Analog√≠a del Mercado de Aplicaciones**
- **App Store:** Donde descargas aplicaciones
- **Hugging Face Spaces:** Donde creas y compartes modelos de IA
- **Ventaja:** Gratuito y de c√≥digo abierto

---

## üöÄ Ventajas de Hugging Face Spaces

### **‚úÖ Ventajas:**
- **Completamente gratuito** - Sin costo de uso
- **C√≥digo abierto** - Transparencia total
- **Comunidad activa** - Mucha ayuda disponible
- **Modelos diversos** - Muchas opciones
- **F√°cil de compartir** - Compartir con otros
- **Personalizable** - Puedes modificar c√≥digo

### **‚ùå Desventajas:**
- **Requiere algo de c√≥digo** - No es 100% visual
- **Curva de aprendizaje** - M√°s t√©cnico
- **Recursos limitados** - GPU compartida
- **Menos documentaci√≥n** - Para principiantes

---

## üìã Preparaci√≥n: Datos de Entrenamiento

### **Ejemplo: Clasificador de Sentimientos para Restaurante**

#### **Objetivo:**
Clasificar comentarios de clientes como:
- **Positivo** - Comentarios buenos
- **Negativo** - Comentarios malos
- **Neutral** - Comentarios neutros

#### **Datos de entrenamiento (formato CSV):**

```csv
text,label
"La comida estuvo deliciosa y el servicio excelente",positivo
"El plato lleg√≥ fr√≠o y tard√≥ mucho en llegar",negativo
"El restaurante est√° bien ubicado",neutral
"Excelente atenci√≥n al cliente, muy recomendable",positivo
"La comida no me gust√≥ para nada",negativo
"El lugar est√° limpio y organizado",neutral
"El mejor restaurante de la ciudad, volver√© seguro",positivo
"P√©simo servicio, nunca m√°s vuelvo",negativo
"El precio est√° bien para la calidad",neutral
"La comida es buena pero el servicio es lento",negativo
"Ambiente agradable y comida casera",positivo
"El restaurante est√° cerrado los lunes",neutral
```

---

## üîß Paso a Paso: Crear Space en Hugging Face

### **Paso 1: Crear Cuenta y Acceder**
1. Ve a [huggingface.co](https://huggingface.co)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email
5. En el men√∫ principal, haz clic en "Spaces"
6. Haz clic en "Create new Space"

### **Paso 2: Configurar el Space**
- **Nombre:** `restaurant-sentiment-classifier`
- **Descripci√≥n:** "Clasificador de sentimientos para comentarios de restaurante"
- **Licencia:** MIT
- **Visibilidad:** P√∫blico
1. Busca "fine-tuning" en los templates
2. Selecciona "Text Classification Fine-tuning"
3. Haz clic en "Use this template"

### **Paso 3: Subir Datos de Entrenamiento**
1. Crea un archivo llamado `train.csv`
2. Copia los datos de entrenamiento
3. En tu Space, haz clic en "Files"
4. Haz clic en "Add file" ‚Üí "Upload file"
5. Selecciona tu archivo `train.csv`
6. Haz clic en "Commit changes"

### **Paso 4: Configurar el Entrenamiento**
1. Ve a "Files" ‚Üí "app.py"
2. Busca la secci√≥n de configuraci√≥n
3. Modifica los par√°metros seg√∫n necesites:

```python
# Configuraci√≥n del modelo
model_name = "distilbert-base-uncased"
num_labels = 3  # positivo, negativo, neutral
max_length = 128
batch_size = 16
epochs = 3
learning_rate = 2e-5
```

### **Paso 5: Iniciar Entrenamiento**
1. Ve a la pesta√±a "App"
2. Haz clic en "Run this Space"
3. El entrenamiento comenzar√° autom√°ticamente
4. Monitorea el progreso (10-30 minutos)

---

## üß™ Paso a Paso: Probar el Modelo

### **Paso 1: Acceder al Modelo Entrenado**
1. Ve a la pesta√±a "App"
2. Ver√°s la interfaz del clasificador
3. El modelo estar√° listo para usar

### **Paso 2: Probar con Comentarios**
- **Campo de texto** - Para escribir comentarios
- **Bot√≥n "Classify"** - Para clasificar
- **Resultado** - Muestra la clasificaci√≥n

#### **Comentarios positivos:**
```
Comentario: "La comida estuvo deliciosa y el servicio excelente"
Resultado esperado: Positivo (95% confianza)
```

#### **Comentarios negativos:**
```
Comentario: "El plato lleg√≥ fr√≠o y tard√≥ mucho en llegar"
Resultado esperado: Negativo (90% confianza)
```

#### **Comentarios neutros:**
```
Comentario: "El restaurante est√° bien ubicado"
Resultado esperado: Neutral (85% confianza)
```

### **Paso 3: Evaluar Resultados**
- **Comentarios positivos** ‚Üí Clasificados como positivos
- **Comentarios negativos** ‚Üí Clasificados como negativos
- **Comentarios neutros** ‚Üí Clasificados como neutros

---

## üìä Resultados Esperados

### **Antes del Fine-tuning (Modelo General):**
- **Comentario:** "La comida estuvo deliciosa"
- **Resultado:** Positivo (60% confianza)

### **Despu√©s del Fine-tuning (Modelo Personalizado):**
- **Comentario:** "La comida estuvo deliciosa"
- **Resultado:** Positivo (95% confianza)

### **Mejoras Obtenidas:**
- ‚úÖ **Mayor precisi√≥n** - Mejor clasificaci√≥n
- ‚úÖ **Mayor confianza** - Modelo m√°s seguro
- ‚úÖ **Mejor comprensi√≥n** - Entiende el contexto del restaurante
- ‚úÖ **Clasificaci√≥n espec√≠fica** - Adaptado a tu dominio

---

## üîç Casos de Prueba

### **Caso 1: Comentario Positivo**
```
Comentario: "Excelente atenci√≥n al cliente, muy recomendable"
Resultado esperado: Positivo (95% confianza)
```

### **Caso 2: Comentario Negativo**
```
Comentario: "P√©simo servicio, nunca m√°s vuelvo"
Resultado esperado: Negativo (98% confianza)
```

### **Caso 3: Comentario Neutral**
```
Comentario: "El precio est√° bien para la calidad"
Resultado esperado: Neutral (85% confianza)
```

### **Caso 4: Comentario Ambiguo**
```
Comentario: "La comida es buena pero el servicio es lento"
Resultado esperado: Negativo (70% confianza)
```

### **Caso 5: Comentario Complejo**
```
Comentario: "El mejor restaurante de la ciudad, volver√© seguro"
Resultado esperado: Positivo (90% confianza)
```

---

## ‚ö†Ô∏è Soluci√≥n de Problemas Comunes

### **Problema 1: Error al subir archivo**
- **Causa:** Formato incorrecto del CSV
- **Soluci√≥n:** Verificar que el CSV tenga las columnas correctas
- **Prevenci√≥n:** Usar un validador CSV online

### **Problema 2: Entrenamiento falla**
- **Causa:** Datos insuficientes o de mala calidad
- **Soluci√≥n:** Revisar y mejorar los datos
- **Prevenci√≥n:** Validar datos antes de subir

### **Problema 3: Modelo no clasifica bien**
- **Causa:** Datos inconsistentes o insuficientes
- **Soluci√≥n:** Agregar m√°s ejemplos de calidad
- **Prevenci√≥n:** Revisar datos antes del entrenamiento

### **Problema 4: Space no se ejecuta**
- **Causa:** Error en el c√≥digo o configuraci√≥n
- **Soluci√≥n:** Revisar logs y corregir errores
- **Prevenci√≥n:** Probar c√≥digo localmente primero

---

## üìà M√©tricas de √âxito

### **M√©tricas Cuantitativas:**
- **Precisi√≥n:** % de clasificaciones correctas
- **Recall:** % de casos positivos detectados
- **F1-Score:** Balance entre precisi√≥n y recall
- **Confianza:** Nivel de seguridad del modelo

### **M√©tricas Cualitativas:**
- **Comprensi√≥n:** ¬øEntiende el contexto del restaurante?
- **Consistencia:** ¬øClasifica similarmente casos similares?
- **Robustez:** ¬øManeja casos ambiguos bien?
- **Utilidad:** ¬øEs √∫til para el negocio?

---

## üí° Consejos para el √âxito

### **1. Calidad de Datos:**
- **Mejor pocos buenos** que muchos regulares
- **Consistencia** en las etiquetas
- **Ejemplos representativos** del dominio

### **2. Iteraci√≥n Continua:**
- **Probar** con casos reales
- **Mejorar** basado en resultados
- **Iterar** constantemente

### **3. Monitoreo:**
- **Revisar** clasificaciones regularmente
- **Identificar** problemas temprano
- **Ajustar** seg√∫n sea necesario

### **4. Compartir:**
- **Documentar** tu proceso
- **Compartir** con la comunidad
- **Aprender** de otros

---

## üîó Compartir tu Modelo

### **Paso 1: Hacer P√∫blico**
1. Ve a "Settings" en tu Space
2. Cambia la visibilidad a "Public"
3. Agrega una descripci√≥n detallada
4. Incluye ejemplos de uso

### **Paso 2: Documentar**
1. Crea un README.md
2. Explica c√≥mo usar el modelo
3. Incluye ejemplos de c√≥digo
4. Documenta limitaciones

### **Paso 3: Promocionar**
1. Comparte en redes sociales
2. Publica en foros de IA
3. Participa en la comunidad
4. Pide feedback

---

## üìä Comparaci√≥n: OpenAI vs Hugging Face

| Caracter√≠stica | OpenAI | Hugging Face |
|----------------|--------|--------------|
| **Facilidad** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **Costo** | üí∞üí∞üí∞ | üÜì |
| **Programaci√≥n** | No | S√≠ |
| **Recursos** | Alto | Medio |
| **Comunidad** | Grande | Muy Grande |
| **Personalizaci√≥n** | Limitada | Alta |
| **Compartir** | Dif√≠cil | F√°cil |

---

## üìù Resumen de Conceptos Clave

### **Proceso completo:**
1. **Crear Space** - En Hugging Face
2. **Subir datos** - Formato CSV correcto
3. **Configurar entrenamiento** - Par√°metros del modelo
4. **Entrenar modelo** - Proceso autom√°tico
5. **Probar resultados** - Con casos reales
6. **Compartir modelo** - Con la comunidad

### **Factores de √©xito:**
- ‚úÖ **Datos de calidad** - Consistentes y etiquetados
- ‚úÖ **Cantidad suficiente** - Al menos 20-50 ejemplos
- ‚úÖ **Casos representativos** - Cubrir situaciones reales
- ‚úÖ **Iteraci√≥n continua** - Mejorar constantemente

### **Errores a evitar:**
- ‚ùå **Datos inconsistentes** - Etiquetas incorrectas
- ‚ùå **Informaci√≥n incorrecta** - Datos desactualizados
- ‚ùå **Pocos ejemplos** - Menos de 10-20
- ‚ùå **No probar** - Desplegar sin validar

---

---

# 2.6 Fine-Tuning para Im√°genes

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Entender el concepto de transfer learning en im√°genes
- Aplicar fine-tuning a modelos de clasificaci√≥n de im√°genes
- Implementar el proceso de dos etapas (clasificador + red completa)
- Adaptar modelos pre-entrenados a nuevas clases con pocos datos

---

## üñºÔ∏è Introducci√≥n al Fine-Tuning de Im√°genes

### **¬øQu√© es el Fine-Tuning de Im√°genes?**
- **Transfer Learning** - Usar un modelo pre-entrenado como base
- **Adaptaci√≥n** - Modificar el modelo para nuevas clases
- **Pocos datos** - Funciona con menos im√°genes que entrenar desde cero
- **Mejor rendimiento** - Aprovecha conocimiento previo del modelo

### **Analog√≠a: Aprender un Nuevo Idioma**
- **Modelo pre-entrenado:** Como saber espa√±ol
- **Fine-tuning:** Como aprender italiano (similar al espa√±ol)
- **Entrenar desde cero:** Como aprender chino (desde cero)
- **Resultado:** Aprendes italiano m√°s r√°pido que chino

---

## üß† Arquitectura de CNN: Dos Partes Principales

### **El fine-tuning para im√°genes se hace en 2 partes principales:**

#### **1. Extracci√≥n de Caracter√≠sticas (Capas Convolucionales)**
- **Funci√≥n:** Detectar patrones y caracter√≠sticas visuales
- **Capas:** Convolucionales, pooling, activaci√≥n
- **Resultado:** Mapas de caracter√≠sticas (features)
- **Analog√≠a:** Como los "ojos" que ven formas, bordes, texturas

#### **2. Clasificaci√≥n de Caracter√≠sticas (Capas Densas)**
- **Funci√≥n:** Tomar decisiones basadas en las caracter√≠sticas
- **Capas:** Fully connected, dense layers
- **Resultado:** Probabilidades de cada clase
- **Analog√≠a:** Como el "cerebro" que interpreta lo que ven los ojos

### **üîç Visualizaci√≥n Interactiva de CNN**

Para entender mejor c√≥mo funcionan las redes neuronales convolucionales, puedes explorar estas visualizaciones interactivas:

- **Visualizaci√≥n 2D:** [https://adamharley.com/nn_vis/cnn/2d.html](https://adamharley.com/nn_vis/cnn/2d.html)
- **Visualizaci√≥n 3D:** [https://adamharley.com/nn_vis/cnn/3d.html](https://adamharley.com/nn_vis/cnn/3d.html)

Estas herramientas te permiten:
- **Dibujar n√∫meros** y ver c√≥mo la red los procesa
- **Observar cada capa** de la red neuronal
- **Entender el flujo** desde imagen hasta predicci√≥n
- **Ver los filtros** en acci√≥n paso a paso

---

## üîß Proceso de Fine-Tuning en Dos Etapas

### **Etapa 1: Reemplazar Clasificador**
#### **¬øQu√© hacemos?**
1. **Cargar modelo grande** - ResNet, VGG, EfficientNet, etc.
2. **Congelar convolucionales** - Mantener caracter√≠sticas aprendidas
3. **Reemplazar clasificador** - Nueva capa para nuestras clases
4. **Entrenar solo clasificador** - R√°pido y eficiente

#### **Ventajas:**
- ‚úÖ **R√°pido** - Solo entrenamos la √∫ltima capa
- ‚úÖ **Eficiente** - Pocos par√°metros a ajustar
- ‚úÖ **Estable** - Caracter√≠sticas base no cambian
- ‚úÖ **Pocos datos** - Funciona con 100-1000 im√°genes

### **Etapa 2: Entrenar Toda la Red**
#### **¬øQu√© hacemos?**
1. **Descongelar toda la red** - Permitir ajustes finos
2. **Learning rate bajo** - Ajustes sutiles
3. **Entrenamiento completo** - Mejora adicional
4. **Validaci√≥n cuidadosa** - Evitar overfitting

#### **Ventajas:**
- ‚úÖ **Mejor rendimiento** - Optimizaci√≥n completa
- ‚úÖ **Adaptaci√≥n fina** - Ajustes espec√≠ficos al dominio
- ‚úÖ **M√°xima precisi√≥n** - Aprovecha todo el modelo

---

## üìä Ejemplo Pr√°ctico: Clasificador de Gatos y Perros

### **Caso de Uso: Identificar Gatos vs Perros**
- **Clases:** Gato, Perro
- **Datos:** 1000 im√°genes por clase (2000 total)
- **Modelo base:** MobileNetV2 pre-entrenado en ImageNet
- **Objetivo:** Clasificar correctamente las 2 clases

**üîó Tutorial completo:** [TensorFlow Transfer Learning](https://www.tensorflow.org/tutorials/images/transfer_learning)

### **Estructura de Datos:**
```
Dataset/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ cats/
‚îÇ   ‚îî‚îÄ‚îÄ dogs/
‚îî‚îÄ‚îÄ validation/
    ‚îú‚îÄ‚îÄ cats/
    ‚îî‚îÄ‚îÄ dogs/
```

---

## üîß Implementaci√≥n con TensorFlow

### **Paso 1: Cargar Modelo Pre-entrenado**
```python
import tensorflow as tf
from tensorflow import keras

# Cargar MobileNetV2 pre-entrenado
base_model = keras.applications.MobileNetV2(
    input_shape=(160, 160, 3),
    include_top=False,
    weights='imagenet'
)

# Congelar capas base
base_model.trainable = False
```

### **Paso 2: Agregar Clasificador**
```python
# Agregar capas de clasificaci√≥n
model = keras.Sequential([
    base_model,
    keras.layers.GlobalAveragePooling2D(),
    keras.layers.Dense(1, activation='sigmoid')
])

model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.0001),
    loss='binary_crossentropy',
    metrics=['accuracy']
)
```

### **Paso 3: Etapa 1 - Entrenar Solo Clasificador**
```python
# Entrenar solo las capas nuevas
initial_epochs = 10
history = model.fit(train_dataset, epochs=initial_epochs, 
                   validation_data=validation_dataset)
```

### **Paso 4: Etapa 2 - Fine-tuning Completo**
```python
# Descongelar capas base
base_model.trainable = True

# Ajustar learning rate m√°s bajo
model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.0001/10),
    loss='binary_crossentropy',
    metrics=['accuracy']
)

# Fine-tuning completo
fine_tune_epochs = 10
total_epochs = initial_epochs + fine_tune_epochs

history_fine = model.fit(train_dataset, epochs=total_epochs,
                        initial_epoch=history.epoch[-1],
                        validation_data=validation_dataset)
```

---

## üìà Resultados del Tutorial

### **Etapa 1: Feature Extraction**
- **Precisi√≥n:** ~97% en validaci√≥n
- **Tiempo:** 10 √©pocas r√°pidas
- **Estado:** Base congelada

### **Etapa 2: Fine-tuning**
- **Precisi√≥n final:** ~98% en validaci√≥n
- **Mejora:** +1% adicional
- **Tiempo:** 10 √©pocas adicionales

### **Resultado Final:**
- **Test accuracy:** 96.8%
- **M√©todo:** MobileNetV2 + fine-tuning
- **Datos:** ~2000 im√°genes gatos/perros

---

## üîç Casos de Prueba

### **Predicci√≥n en Lote:**
```python
# Obtener batch de im√°genes de prueba
image_batch, label_batch = test_dataset.as_numpy_iterator().next()
predictions = model.predict_on_batch(image_batch).flatten()
predictions = tf.where(predictions < 0.5, 0, 1)

# Resultado: 96.8% accuracy en test set
```

### **Casos T√≠picos:**
- **Gatos claros:** 95%+ confianza
- **Perros claros:** 95%+ confianza  
- **Im√°genes ambiguas:** 70-90% confianza
- **Casos dif√≠ciles:** 60-80% confianza

---

## ‚ö†Ô∏è Puntos Clave

### **Overfitting:**
- **S√≠ntoma:** Validation loss > Training loss
- **Soluci√≥n:** Data augmentation, menos √©pocas

### **Learning Rate:**
- **Clasificador:** 0.0001 (normal)
- **Fine-tuning:** 0.00001 (10x menor)

### **Datos:**
- **M√≠nimo:** 100 im√°genes por clase
- **Recomendado:** 1000+ por clase
- **Balance:** Mismo n√∫mero de ejemplos por clase

---

## üìù Resumen

### **Proceso:**
1. **Feature Extraction:** Congelar base, entrenar clasificador
2. **Fine-tuning:** Descongelar base, learning rate bajo
3. **Resultado:** 96.8% accuracy con 2000 im√°genes

### **Ventajas:**
- ‚úÖ **R√°pido:** 20 √©pocas vs 100+ desde cero
- ‚úÖ **Eficiente:** Menos datos necesarios
- ‚úÖ **Preciso:** Mejor rendimiento que entrenar desde cero

### **Requisitos:**
- ‚úÖ **Modelo pre-entrenado:** MobileNetV2, ResNet, etc.
- ‚úÖ **Datos balanceados:** Mismo n√∫mero por clase
- ‚úÖ **Learning rate:** 10x menor para fine-tuning

---

# 2.7 Ejemplo con LangChain y Hugging Face

## üéØ Objetivos de esta Secci√≥n

Al finalizar esta secci√≥n, los participantes podr√°n:
- Integrar modelos de Hugging Face con LangChain
- Crear aplicaciones de IA usando componentes modulares
- Implementar pipelines de procesamiento de texto
- Desplegar soluciones usando ambas plataformas

---

## üîó LangChain + Hugging Face

### **LangChain:**
- **Framework** para aplicaciones de IA
- **Componentes modulares** - Construir apps complejas
- **Integraci√≥n f√°cil** - Conectar servicios

### **Ejemplo: Chatbot con RAG**
- **Caso:** Asistente de ventas con cat√°logo de productos
- **Modelo:** Hugging Face (DialoGPT)
- **Funci√≥n:** Responder preguntas sobre productos

### **Arquitectura:**
```
Usuario ‚Üí LangChain ‚Üí HF Model ‚Üí Base Conocimiento ‚Üí Respuesta
```

---

## üîß Implementaci√≥n

### **1. Instalar Dependencias**
```bash
pip install langchain transformers torch sentence-transformers chromadb streamlit
```

### **2. Configurar Modelo**
```python
from langchain.llms import HuggingFacePipeline
from transformers import pipeline

# Cargar modelo Hugging Face
hf_pipeline = pipeline("text-generation", 
                      model="microsoft/DialoGPT-medium")

# Integrar con LangChain
llm = HuggingFacePipeline(pipeline=hf_pipeline)
```

### **3. Base de Conocimiento**
```python
from langchain.vectorstores import Chroma
from langchain.embeddings import HuggingFaceEmbeddings

# Documentos de productos
docs = [
    "iPhone 15: 6.1 pulgadas, 48MP c√°mara, A17 Pro",
    "MacBook Pro M2: 16GB RAM, 512GB SSD, 14 pulgadas"
]

# Crear embeddings y base vectorial
embeddings = HuggingFaceEmbeddings(model_name="all-MiniLM-L6-v2")
vectorstore = Chroma.from_texts(docs, embeddings)
```

### **4. Chain de RAG**
```python
from langchain.chains import RetrievalQA

# Crear chain pregunta-respuesta
qa_chain = RetrievalQA.from_chain_type(
    llm=llm,
    retriever=vectorstore.as_retriever()
)
```

### **5. Interfaz Streamlit**
```python
import streamlit as st

st.title("ü§ñ Asistente de Ventas")
question = st.text_input("¬øQu√© te gustar√≠a saber?")

if question:
    answer = qa_chain({"query": question})
    st.write(answer["result"])
```

---

## üß™ Casos de Prueba

### **Ejemplos:**
- **"¬øQu√© caracter√≠sticas tiene el iPhone 15?"** ‚Üí Info pantalla, c√°mara, procesador
- **"¬øCu√°nta RAM tiene la MacBook Pro?"** ‚Üí "16GB de RAM"
- **"¬øQu√© accesorios tienen cancelaci√≥n de ruido?"** ‚Üí Info AirPods Pro

---

## üìä Resultados

### **Funcionalidades:**
- ‚úÖ **B√∫squeda sem√°ntica** - Encuentra info relevante
- ‚úÖ **Respuestas contextuales** - Basadas en conocimiento
- ‚úÖ **Interfaz amigable** - F√°cil de usar
- ‚úÖ **Escalable** - Agregar m√°s productos f√°cil

### **Ventajas:**
- ‚úÖ **Modular** - Componentes independientes
- ‚úÖ **Flexible** - Cambiar modelos f√°cil
- ‚úÖ **Mantenible** - C√≥digo organizado

---

## üìù Resumen

### **LangChain + Hugging Face:**
- **LangChain:** Orquesta componentes
- **Hugging Face:** Modelos pre-entrenados
- **Resultado:** Apps modulares y escalables

### **Casos de uso:**
- **Chatbots** con base de conocimiento
- **Asistentes virtuales** empresariales
- **Sistemas Q&A** para documentaci√≥n

---

*Este material est√° dise√±ado para ser accesible y comprensible para personas sin conocimientos t√©cnicos avanzados. Las analog√≠as y ejemplos ayudan a entender conceptos complejos de manera simple.*
