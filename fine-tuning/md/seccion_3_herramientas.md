# SecciÃ³n 2: Herramientas para Fine-Tuning

Material de Soporte para el Curso de Fine-Tuning

---

# 2.1 Herramientas Online Principales

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Conocer las principales herramientas online para fine-tuning
- Entender las ventajas y desventajas de cada una
- Elegir la herramienta mÃ¡s adecuada para su caso
- Comenzar a usar las herramientas bÃ¡sicas

---

## ğŸŒ IntroducciÃ³n a las Herramientas Online

### **Â¿Por quÃ© usar herramientas online?**
- **Sin instalaciones** - No necesitas configurar nada
- **Sin programaciÃ³n** - Interfaces visuales fÃ¡ciles
- **Acceso inmediato** - Empiezas en minutos
- **Escalabilidad** - Recursos segÃºn necesites

### **Â¿QuÃ© necesitas para empezar?**
- **ConexiÃ³n a internet** - Estable y rÃ¡pida
- **Navegador web** - Chrome, Firefox, Safari, etc.
- **Cuenta de usuario** - Registro gratuito
- **Datos de entrenamiento** - Preparados en formato correcto

---

## ğŸš€ OpenAI Fine-tuning

### **Â¿QuÃ© es OpenAI?**
- **Empresa lÃ­der** en inteligencia artificial
- **Creadores de GPT** - Los modelos mÃ¡s populares
- **Plataforma comercial** - Servicios profesionales
- **API robusta** - Para desarrolladores y empresas

### **CaracterÃ­sticas Principales**
- **Modelos avanzados** - GPT-3.5, GPT-4, etc.
- **Interfaz simple** - FÃ¡cil de usar
- **DocumentaciÃ³n excelente** - Muchos recursos
- **Soporte comercial** - Ayuda profesional

### **Â¿CuÃ¡ndo usar OpenAI?**
- **Proyectos comerciales** - Necesitas confiabilidad
- **Presupuesto disponible** - Tiene costo
- **Sin experiencia tÃ©cnica** - Muy fÃ¡cil de usar
- **Resultados rÃ¡pidos** - Proceso automatizado

---

## ğŸ¤— Hugging Face Spaces

### **Â¿QuÃ© es Hugging Face?**
- **Comunidad abierta** de IA
- **Modelos gratuitos** - Miles disponibles
- **CÃ³digo abierto** - Transparencia total
- **ColaboraciÃ³n** - Compartir y aprender

### **CaracterÃ­sticas Principales**
- **Completamente gratuito** - Sin costo
- **Templates listos** - Para fine-tuning
- **Comunidad activa** - Mucha ayuda
- **Personalizable** - Puedes modificar cÃ³digo

### **Â¿CuÃ¡ndo usar Hugging Face?**
- **ExperimentaciÃ³n** - Probar ideas
- **Presupuesto limitado** - Sin costo
- **Aprendizaje** - Entender el proceso
- **Proyectos open source** - Compartir resultados

---

## ğŸ”§ Otras Opciones

### **Google Colab**
- **Gratuito** - Con limitaciones
- **Jupyter notebooks** - Interfaz de programaciÃ³n
- **GPUs gratuitas** - Para entrenamiento
- **IntegraciÃ³n con Google** - Drive, etc.

### **Replicate**
- **Modelos pre-entrenados** - Listos para usar
- **API simple** - FÃ¡cil integraciÃ³n
- **Precios por uso** - Solo pagas lo que usas
- **Sin configuraciÃ³n** - Plug and play

---

## ğŸ¯ Recomendaciones por Caso de Uso

### **Para Principiantes:**
- **OpenAI** - MÃ¡s fÃ¡cil de usar
- **Interfaz visual** - Sin programaciÃ³n
- **DocumentaciÃ³n clara** - Muchos tutoriales
- **Soporte** - Ayuda disponible

### **Para ExperimentaciÃ³n:**
- **Hugging Face** - Gratuito y flexible
- **Templates** - CÃ³digo listo para usar
- **Comunidad** - Mucha ayuda
- **Personalizable** - Puedes modificar

### **Para ProducciÃ³n:**
- **OpenAI** - MÃ¡s confiable
- **SLA** - GarantÃ­as de servicio
- **Escalabilidad** - Recursos segÃºn necesites
- **Soporte comercial** - Ayuda profesional

---

## ğŸš€ CÃ³mo Empezar con OpenAI

### **Paso 1: Crear Cuenta**
1. Ve a [platform.openai.com](https://platform.openai.com)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email

### **Paso 2: Configurar Billing**
1. Ve a "Billing" en tu cuenta
2. Agrega mÃ©todo de pago
3. Establece lÃ­mites de gasto
4. Confirma la configuraciÃ³n

### **Paso 3: Preparar Datos**
1. Crea archivo JSONL
2. Formato correcto de datos
3. Al menos 10 ejemplos
4. Datos de calidad

### **Paso 4: Crear Fine-tuning**
1. Ve a "Fine-tuning"
2. Sube tu archivo de datos
3. Configura parÃ¡metros
4. Inicia el entrenamiento

---

## ğŸ¤— CÃ³mo Empezar con Hugging Face

### **Paso 1: Crear Cuenta**
1. Ve a [huggingface.co](https://huggingface.co)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email

### **Paso 2: Crear Space**
1. Ve a "Spaces"
2. Haz clic en "Create new Space"
3. Elige template de fine-tuning
4. Configura tu Space

### **Paso 3: Subir Datos**
1. Ve a "Files" en tu Space
2. Sube archivo de datos
3. Formato CSV o JSONL
4. Confirma la subida

### **Paso 4: Ejecutar Entrenamiento**
1. Ve a pestaÃ±a "App"
2. Haz clic en "Run this Space"
3. Monitorea el progreso
4. Prueba el modelo

---

## ğŸ’¡ Consejos para Elegir Herramienta

### **Si eres principiante:**
- **OpenAI** - MÃ¡s fÃ¡cil de empezar
- **Interfaz visual** - Sin programaciÃ³n
- **DocumentaciÃ³n** - Muchos recursos
- **Soporte** - Ayuda disponible

### **Si tienes presupuesto limitado:**
- **Hugging Face** - Completamente gratuito
- **Google Colab** - Gratuito con limitaciones
- **Replicate** - Solo pagas por uso

### **Si necesitas resultados rÃ¡pidos:**
- **OpenAI** - Proceso automatizado
- **Replicate** - Modelos pre-entrenados
- **Templates** - CÃ³digo listo

### **Si quieres aprender:**
- **Hugging Face** - CÃ³digo abierto
- **Google Colab** - Jupyter notebooks
- **Comunidad** - Mucha ayuda

---

## ğŸ” DemostraciÃ³n en Vivo

### **Demo 1: OpenAI Platform**
- Mostrar interfaz de usuario
- Crear fine-tuning paso a paso
- Probar modelo entrenado
- Explicar resultados

### **Demo 2: Hugging Face Spaces**
- Crear nuevo Space
- Usar template de fine-tuning
- Subir datos de ejemplo
- Ejecutar entrenamiento

### **Demo 3: ComparaciÃ³n de Resultados**
- Mismo dataset en ambas plataformas
- Comparar calidad de respuestas
- Analizar costos y tiempo
- Recomendaciones finales

---

## âš ï¸ Consideraciones Importantes

### **Privacidad de Datos**
- **OpenAI:** Datos pueden ser revisados
- **Hugging Face:** Datos pÃºblicos por defecto
- **Google Colab:** Datos en Google Cloud
- **Replicate:** Datos procesados por terceros

### **Costo a Largo Plazo**
- **OpenAI:** Costo por token usado
- **Hugging Face:** Gratuito (con limitaciones)
- **Google Colab:** Gratuito (con lÃ­mites)
- **Replicate:** Pago por uso

### **Escalabilidad**
- **OpenAI:** Escalable comercialmente
- **Hugging Face:** Limitado por recursos gratuitos
- **Google Colab:** Limitado por sesiones
- **Replicate:** Escalable segÃºn presupuesto

---

## ğŸ“ Resumen de Conceptos Clave

### **Herramientas principales:**
- **OpenAI:** Comercial, fÃ¡cil, confiable
- **Hugging Face:** Gratuito, flexible, comunitario
- **Google Colab:** Gratuito, programaciÃ³n, limitado
- **Replicate:** Pago por uso, simple, rÃ¡pido

### **Para elegir:**
- **Principiantes:** OpenAI
- **ExperimentaciÃ³n:** Hugging Face
- **Presupuesto limitado:** Hugging Face o Colab
- **ProducciÃ³n:** OpenAI

### **Consideraciones:**
- **Privacidad:** Revisar polÃ­ticas de datos
- **Costo:** Evaluar a largo plazo
- **Escalabilidad:** Planificar crecimiento
- **Soporte:** Disponibilidad de ayuda

# 2.2 Formatos de Datos: JSON y JSONL

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Entender quÃ© son los formatos JSON y JSONL
- Diferenciar entre JSON y JSONL
- Crear archivos JSONL para fine-tuning
- Validar y formatear datos correctamente

---

## ğŸ“„ Â¿QuÃ© es JSON?

### **JSON (JavaScript Object Notation)**
- **Formato de datos** - Manera estÃ¡ndar de organizar informaciÃ³n
- **Legible para humanos** - FÃ¡cil de leer y escribir
- **Universal** - Usado en casi todas las aplicaciones web
- **Estructura simple** - Pares de clave-valor

### **AnalogÃ­a: JSON como una Ficha Personal**
Imagina que JSON es como llenar una ficha con tus datos:
```json
{
  "nombre": "MarÃ­a GarcÃ­a",
  "edad": 30,
  "ciudad": "Madrid",
  "hobbies": ["leer", "cocinar", "viajar"]
}
```

### **Elementos de JSON:**
- **Llaves {}** - Contenedor principal
- **Comillas ""** - Para texto
- **Coma ,** - Separar elementos
- **Corchetes []** - Para listas
- **Dos puntos :** - Separar clave de valor

---

## ğŸ“„ Â¿QuÃ© es JSONL?

### **JSONL (JSON Lines)**
- **JSON por lÃ­nea** - Cada lÃ­nea es un JSON completo
- **Formato para datasets** - Ideal para grandes cantidades de datos
- **FÃ¡cil de procesar** - Se lee lÃ­nea por lÃ­nea
- **EstÃ¡ndar en IA** - Usado en fine-tuning

### **AnalogÃ­a: JSONL como un Directorio TelefÃ³nico**
Cada lÃ­nea es una entrada independiente:
```jsonl
{"nombre": "MarÃ­a GarcÃ­a", "telÃ©fono": "123-456-789", "ciudad": "Madrid"}
{"nombre": "Juan LÃ³pez", "telÃ©fono": "987-654-321", "ciudad": "Barcelona"}
{"nombre": "Ana Ruiz", "telÃ©fono": "555-123-456", "ciudad": "Valencia"}
```

### **CaracterÃ­sticas JSONL:**
- **Una lÃ­nea = Un registro** - Cada lÃ­nea es independiente
- **Sin comas entre lÃ­neas** - No hay separadores
- **FÃ¡cil de agregar** - Solo aÃ±adir nueva lÃ­nea
- **Procesamiento eficiente** - Se lee de a una lÃ­nea

---

## ğŸ”„ Diferencias: JSON vs JSONL

### **JSON Tradicional:**
```json
[
  {
    "messages": [
      {"role": "user", "content": "Â¿QuÃ© laptop recomiendas?"},
      {"role": "assistant", "content": "Te recomiendo la MacBook Pro M2"}
    ]
  },
  {
    "messages": [
      {"role": "user", "content": "Â¿CuÃ¡nto cuesta?"},
      {"role": "assistant", "content": "Cuesta $1,999 con 16GB de RAM"}
    ]
  }
]
```

### **JSONL (JSON Lines):**
```jsonl
{"messages": [{"role": "user", "content": "Â¿QuÃ© laptop recomiendas?"}, {"role": "assistant", "content": "Te recomiendo la MacBook Pro M2"}]}
{"messages": [{"role": "user", "content": "Â¿CuÃ¡nto cuesta?"}, {"role": "assistant", "content": "Cuesta $1,999 con 16GB de RAM"}]}
```

### **ComparaciÃ³n:**

| CaracterÃ­stica | JSON | JSONL |
|----------------|------|-------|
| **Estructura** | Array completo | Una lÃ­nea = Un objeto |
| **TamaÃ±o** | Todo en memoria | Procesamiento lÃ­nea por lÃ­nea |
| **Fine-tuning** | No compatible | âœ… Formato requerido |
| **EdiciÃ³n** | DifÃ­cil para datasets grandes | âœ… FÃ¡cil agregar/quitar |
| **ValidaciÃ³n** | Todo o nada | LÃ­nea por lÃ­nea |

---

## ğŸ› ï¸ Crear Archivos JSONL para Fine-Tuning

### **Formato para Chatbots (OpenAI):**
Cada lÃ­nea debe tener esta estructura:
```jsonl
{"messages": [{"role": "user", "content": "PREGUNTA"}, {"role": "assistant", "content": "RESPUESTA"}]}
```


## âœ… ValidaciÃ³n de Archivos JSONL

### **Reglas Importantes:**
1. **Una lÃ­nea = Un JSON completo** - No dividir en mÃºltiples lÃ­neas
2. **JSON vÃ¡lido** - Cada lÃ­nea debe ser JSON correcto
3. **Sin comas al final** - Entre lÃ­neas no hay separadores
4. **CodificaciÃ³n UTF-8** - Para caracteres especiales
5. **Estructura consistente** - Mismo formato en todas las lÃ­neas

### **Errores Comunes:**
âŒ **JSON multilÃ­nea:**
```json
{
  "messages": [
    {"role": "user", "content": "Pregunta"},
    {"role": "assistant", "content": "Respuesta"}
  ]
}
```

âœ… **JSONL correcto:**
```jsonl
{"messages": [{"role": "user", "content": "Pregunta"}, {"role": "assistant", "content": "Respuesta"}]}
```

### **Herramientas de ValidaciÃ³n:**
- **JSONLint:** [jsonlint.com](https://jsonlint.com) - Validar JSON
- **Editor de texto** - Verificar formato lÃ­nea por lÃ­nea
- **Python:** Usar `json.loads()` para cada lÃ­nea

---

## ğŸ”§ Herramientas para Crear JSONL

### **1. Editor de Texto Simple**
- **Notepad++** (Windows)
- **TextEdit** (Mac)
- **VS Code** (Multiplataforma)
- **Sublime Text** (Multiplataforma)
- **Vim â¤ï¸** (Linux)


### **2. Convertir CSV a JSONL**
Si tienes datos en Excel/CSV:
```python
import csv
import json

# Leer CSV y convertir a JSONL
with open('datos.csv', 'r') as csv_file:
    with open('training_data.jsonl', 'w') as jsonl_file:
        reader = csv.DictReader(csv_file)
        for row in reader:
            jsonl_line = {
                "messages": [
                    {"role": "user", "content": row["pregunta"]},
                    {"role": "assistant", "content": row["respuesta"]}
                ]
            }
            jsonl_file.write(json.dumps(jsonl_line, ensure_ascii=False) + '\n')
```

### **3. Plantilla Excel para JSONL**
Crear Excel con columnas:
- **Columna A:** Pregunta
- **Columna B:** Respuesta
- **Columna C:** FÃ³rmula para generar JSONL

---

## ğŸ“Š Mejores PrÃ¡cticas para JSONL

### **Cantidad de Datos:**
- **MÃ­nimo:** 10-20 ejemplos
- **Recomendado:** 50-100 ejemplos
- **Ã“ptimo:** 100-1000 ejemplos de alta calidad

### **Calidad sobre Cantidad:**
- âœ… **50 ejemplos excelentes** > 200 ejemplos regulares
- âœ… **Consistencia** en el estilo y tono
- âœ… **Diversidad** en tipos de preguntas
- âœ… **PrecisiÃ³n** en las respuestas

### **Estructura de Respuestas:**
- **EspecÃ­ficas** - No genÃ©ricas
- **Ãštiles** - Que resuelvan problemas reales
- **Consistentes** - Mismo tono y estilo
- **Completas** - Con informaciÃ³n suficiente

---

## ğŸ§ª Ejemplo PrÃ¡ctico: Crear Dataset

### **Caso: Restaurante "La Bella Italia"**
Vamos a crear un dataset para un chatbot de restaurante:

```jsonl
{"messages": [{"role": "user", "content": "Â¿QuÃ© platos tienen de pasta?"}, {"role": "assistant", "content": "Tenemos varios platos de pasta deliciosos: Spaghetti Carbonara ($15), LasaÃ±a de la Casa ($18), Fettuccine Alfredo ($16) y Ravioli de Ricotta y Espinaca ($17). Todas nuestras pastas son caseras. Â¿Te interesa alguna en particular?"}]}
{"messages": [{"role": "user", "content": "Â¿Tienen opciones vegetarianas?"}, {"role": "assistant", "content": "Â¡SÃ­! Tenemos excelentes opciones vegetarianas: Pizza Margherita ($14), Ensalada Caprese ($12), Risotto de ChampiÃ±ones ($16) y nuestros Ravioli de Ricotta y Espinaca ($17). TambiÃ©n podemos adaptar varios platos quitando la carne. Â¿Hay alguna preferencia especÃ­fica?"}]}
{"messages": [{"role": "user", "content": "Â¿CuÃ¡l es el horario de atenciÃ³n?"}, {"role": "assistant", "content": "Estamos abiertos de martes a domingo. Martes a jueves de 12:00 PM a 10:00 PM, viernes y sÃ¡bados de 12:00 PM a 11:00 PM, y domingos de 12:00 PM a 9:00 PM. Los lunes permanecemos cerrados. Â¿Te gustarÃ­a hacer una reserva?"}]}
{"messages": [{"role": "user", "content": "Â¿Hacen delivery?"}, {"role": "assistant", "content": "SÃ­, hacemos delivery en un radio de 5 km del restaurante. El costo de envÃ­o es de $3 para pedidos menores a $25, y es gratuito para pedidos superiores a $25. El tiempo de entrega es de 30-45 minutos. Puedes pedir por telÃ©fono o WhatsApp. Â¿En quÃ© zona te encuentras?"}]}
```

---

## ğŸ“ Resumen de Conceptos Clave

### **JSON:**
- **Formato estÃ¡ndar** para intercambio de datos
- **Estructura:** Llaves, comillas, comas, dos puntos
- **Uso:** Configuraciones, APIs, almacenamiento

### **JSONL:**
- **JSON por lÃ­nea** - Cada lÃ­nea es independiente
- **Ideal para datasets** - Grandes cantidades de datos
- **Requerido** para fine-tuning en OpenAI

### **Para Fine-tuning:**
1. **Crear archivo JSONL** - Una conversaciÃ³n por lÃ­nea
2. **Validar formato** - JSON correcto en cada lÃ­nea
3. **Calidad de datos** - Consistentes y Ãºtiles
4. **Cantidad suficiente** - MÃ­nimo 20, ideal 50-100

### **Errores a evitar:**
- âŒ JSON multilÃ­nea en JSONL
- âŒ Comas entre lÃ­neas JSONL
- âŒ Caracteres especiales sin UTF-8
- âŒ Datos inconsistentes o genÃ©ricos

---

# 2.4 Demo: Fine-Tuning con OpenAI

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Crear un fine-tuning en OpenAI paso a paso
- Entender el proceso completo de entrenamiento
- Probar y evaluar un modelo fine-tuned
- Identificar mejores prÃ¡cticas y errores comunes

---

## ğŸš€ IntroducciÃ³n a la Demo

### **Â¿QuÃ© vamos a hacer?**
Vamos a crear un **chatbot de ventas** para una tienda de tecnologÃ­a usando OpenAI Fine-tuning.

### **Caso de Uso: TechStore**
- **Productos:** Laptops, smartphones, tablets
- **Objetivo:** Responder preguntas sobre productos
- **Tono:** Profesional pero amigable
- **Datos:** 20 conversaciones de ventas reales

### **Resultado Esperado**
- **Antes:** Respuestas genÃ©ricas sobre tecnologÃ­a
- **DespuÃ©s:** Respuestas especÃ­ficas sobre productos de TechStore

---

## ğŸ“‹ PreparaciÃ³n: Datos de Entrenamiento

### **Ejemplo: Chatbot de Ventas para TechStore**

#### **Objetivo:**
Responder preguntas sobre productos especÃ­ficos de la tienda

#### **Datos de entrenamiento (formato JSONL):**

```json
{"messages": [{"role": "user", "content": "Â¿QuÃ© laptop me recomiendas para programar?"}, {"role": "assistant", "content": "Para programar te recomiendo la MacBook Pro M2 de 14 pulgadas. Tiene 16GB de RAM, 512GB SSD y procesador M2 que es perfecto para desarrollo. Cuesta $1,999 y estÃ¡ disponible en gris espacial. Â¿Te interesa ver las especificaciones completas?"}]}
{"messages": [{"role": "user", "content": "Â¿Tienen iPhone 15 en stock?"}, {"role": "assistant", "content": "SÃ­, tenemos iPhone 15 en stock en varios colores y capacidades. Tenemos el modelo base de 128GB desde $799 y el Pro de 256GB desde $999. Â¿QuÃ© color prefieres? Tenemos azul, rosa, amarillo, verde y negro."}]}
{"messages": [{"role": "user", "content": "Â¿CuÃ¡l es la garantÃ­a de los productos?"}, {"role": "assistant", "content": "Todos nuestros productos tienen garantÃ­a del fabricante: MacBook y iPhone tienen 1 aÃ±o de garantÃ­a de Apple, las laptops Windows tienen 2 aÃ±os y los accesorios tienen 1 aÃ±o. AdemÃ¡s, ofrecemos garantÃ­a extendida de hasta 3 aÃ±os por $99 adicionales. Â¿Te interesa agregar garantÃ­a extendida?"}]}
```

---

## ğŸ”§ Paso a Paso: Crear Fine-Tuning en OpenAI

### **Paso 1: Acceder a OpenAI Platform**
1. Ve a [platform.openai.com](https://platform.openai.com)
2. Inicia sesiÃ³n con tu cuenta
3. Ve a la secciÃ³n "Fine-tuning"
4. Haz clic en "Create a fine-tune"

### **Paso 2: Subir Archivo de Datos**
1. Haz clic en "Upload file"
2. Selecciona tu archivo JSONL
3. Verifica que el formato sea correcto
4. Haz clic en "Upload"

### **Paso 3: Configurar ParÃ¡metros**
1. Selecciona el modelo base (gpt-3.5-turbo)
2. Establece el nÃºmero de Ã©pocas (3-5)
3. Configura el learning rate (automÃ¡tico)
4. Establece el batch size (automÃ¡tico)

### **Paso 4: Iniciar Entrenamiento**
1. Revisa la configuraciÃ³n
2. Haz clic en "Create fine-tune"
3. Espera a que termine el entrenamiento
4. Recibe notificaciÃ³n de finalizaciÃ³n

![Interfaz principal de Fine-tuning en OpenAI Platform](images/ft_open_ai_1.png)
**Interfaz principal de Fine-tuning en OpenAI Platform** - Vista del dashboard con opciones disponibles

![Crear nuevo modelo de Fine-tuning](images/ft_open_ai_2.png)
**Crear nuevo modelo de Fine-tuning** - SelecciÃ³n de modelo base y carga de datos de entrenamiento

![ConfiguraciÃ³n de parÃ¡metros de Fine-tuning](images/ft_open_ai_3.png)
**ConfiguraciÃ³n de parÃ¡metros de Fine-tuning** - Ajustes de hiperparÃ¡metros y opciones avanzadas

---

## ğŸ§ª Paso a Paso: Probar el Modelo

### **Paso 1: Acceder al Modelo Entrenado**
1. Ve a la secciÃ³n "Fine-tunes"
2. Encuentra tu modelo entrenado
3. Haz clic en "View details"
4. Copia el ID del modelo

### **Paso 2: Usar OpenAI Playground**
1. Ve a "Playground" en la plataforma
2. Selecciona tu modelo fine-tuned
3. Escribe una pregunta de prueba
4. Observa la respuesta generada

### **Paso 3: Comparar Resultados**
1. Prueba con el modelo general
2. Prueba con tu modelo fine-tuned
3. Compara la calidad de respuestas
4. Identifica mejoras obtenidas

---

## ğŸ“Š Resultados Esperados

### **Antes del Fine-tuning (Modelo General):**
- **Pregunta:** "Â¿QuÃ© laptop me recomiendas para programar?"
- **Respuesta:** "Para programar te recomiendo una laptop con al menos 8GB de RAM, procesador Intel i5 o AMD Ryzen 5, y SSD para mejor rendimiento. Algunas opciones populares son Dell XPS, MacBook Pro, o ThinkPad."

### **DespuÃ©s del Fine-tuning (Modelo Personalizado):**
- **Pregunta:** "Â¿QuÃ© laptop me recomiendas para programar?"
- **Respuesta:** "Para programar te recomiendo la MacBook Pro M2 de 14 pulgadas. Tiene 16GB de RAM, 512GB SSD y procesador M2 que es perfecto para desarrollo. Cuesta $1,999 y estÃ¡ disponible en gris espacial. Â¿Te interesa ver las especificaciones completas?"

### **Mejoras Obtenidas:**
- âœ… **EspecÃ­fico:** Menciona productos exactos de la tienda
- âœ… **Informativo:** Incluye precios y especificaciones
- âœ… **Comercial:** Invita a continuar la conversaciÃ³n
- âœ… **Consistente:** Mantiene el tono de la marca

---

## ğŸ” Casos de Prueba

### **Caso 1: Pregunta sobre Producto EspecÃ­fico**
- **Pregunta:** "Â¿Tienen MacBook Air en stock?"
- **Resultado esperado:** InformaciÃ³n especÃ­fica sobre disponibilidad, precios y colores

### **Caso 2: Pregunta sobre GarantÃ­a**
- **Pregunta:** "Â¿CuÃ¡l es la garantÃ­a de los productos?"
- **Resultado esperado:** InformaciÃ³n detallada sobre garantÃ­as y opciones extendidas

### **Caso 3: Pregunta sobre RecomendaciÃ³n**
- **Pregunta:** "Â¿QuÃ© smartphone me recomiendas para fotografÃ­a?"
- **Resultado esperado:** RecomendaciÃ³n especÃ­fica con justificaciÃ³n tÃ©cnica

### **Caso 4: Pregunta sobre Precio**
- **Pregunta:** "Â¿CuÃ¡nto cuesta el iPhone 15 Pro?"
- **Resultado esperado:** Precio exacto y opciones de financiamiento

### **Caso 5: Pregunta GenÃ©rica**
- **Pregunta:** "Â¿QuÃ© productos tienen?"
- **Resultado esperado:** Lista de categorÃ­as principales con invitaciÃ³n a explorar

---

## âš ï¸ SoluciÃ³n de Problemas Comunes

### **Problema 1: Error al subir archivo**
- **Causa:** Formato incorrecto del JSONL
- **SoluciÃ³n:** Verificar que cada lÃ­nea sea un JSON vÃ¡lido
- **PrevenciÃ³n:** Usar un validador JSON online

### **Problema 2: Entrenamiento falla**
- **Causa:** Datos insuficientes o de mala calidad
- **SoluciÃ³n:** Revisar y mejorar los datos
- **PrevenciÃ³n:** Validar datos antes de subir

### **Problema 3: Modelo no responde bien**
- **Causa:** Datos inconsistentes o insuficientes
- **SoluciÃ³n:** Agregar mÃ¡s ejemplos de calidad
- **PrevenciÃ³n:** Revisar datos antes del entrenamiento

### **Problema 4: Costo muy alto**
- **Causa:** Muchos datos o entrenamiento repetido
- **SoluciÃ³n:** Optimizar cantidad de datos
- **PrevenciÃ³n:** Establecer lÃ­mites de costo

---

## ğŸ“ˆ MÃ©tricas de Ã‰xito

### **MÃ©tricas Cuantitativas:**
- **PrecisiÃ³n:** % de respuestas correctas
- **Relevancia:** % de respuestas Ãºtiles
- **Consistencia:** % de respuestas coherentes
- **Velocidad:** Tiempo de respuesta

### **MÃ©tricas Cualitativas:**
- **Tono:** Â¿Suena como un vendedor de TechStore?
- **InformaciÃ³n:** Â¿Conoce los productos especÃ­ficos?
- **PersuasiÃ³n:** Â¿Maneja objeciones bien?
- **Experiencia:** Â¿Es Ãºtil para el usuario?

---

## ğŸ’¡ Consejos para el Ã‰xito

### **1. Calidad de Datos:**
- **Mejor pocos buenos** que muchos regulares
- **Consistencia** en el estilo y tono
- **InformaciÃ³n precisa** y actualizada

### **2. IteraciÃ³n Continua:**
- **Probar** con casos reales
- **Mejorar** basado en resultados
- **Iterar** constantemente

### **3. Monitoreo:**
- **Revisar** respuestas regularmente
- **Identificar** problemas temprano
- **Ajustar** segÃºn sea necesario

### **4. Escalabilidad:**
- **Empezar pequeÃ±o** y crecer
- **Planificar** para el futuro
- **Considerar** costos a largo plazo

---

## ğŸ“ Resumen de Conceptos Clave

### **Proceso completo:**
1. **Preparar datos** - Formato JSONL correcto
2. **Subir archivo** - A OpenAI Platform
3. **Configurar parÃ¡metros** - Modelo y opciones
4. **Entrenar modelo** - Proceso automÃ¡tico
5. **Probar resultados** - Con casos reales
6. **Evaluar y mejorar** - IteraciÃ³n continua

### **Factores de Ã©xito:**
- âœ… **Datos de calidad** - Consistentes y precisos
- âœ… **Cantidad suficiente** - Al menos 20-50 ejemplos
- âœ… **Casos representativos** - Cubrir situaciones reales
- âœ… **IteraciÃ³n continua** - Mejorar constantemente

### **Errores a evitar:**
- âŒ **Datos inconsistentes** - Diferentes estilos
- âŒ **InformaciÃ³n incorrecta** - Datos desactualizados
- âŒ **Pocos ejemplos** - Menos de 10-20
- âŒ **No probar** - Desplegar sin validar

---

# 2.5 Demo: Hugging Face Spaces

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Crear un Space en Hugging Face
- Usar templates de fine-tuning
- Entrenar un modelo personalizado
- Compartir y desplegar el modelo

---

## ğŸ¤— IntroducciÃ³n a Hugging Face Spaces

### **Â¿QuÃ© es Hugging Face?**
- **Plataforma** de cÃ³digo abierto para IA
- **Comunidad** de desarrolladores y investigadores
- **Modelos gratuitos** - Miles de modelos disponibles
- **Spaces** - Aplicaciones web para IA

### **Â¿QuÃ© son los Spaces?**
- **Aplicaciones web** que puedes crear y compartir
- **Templates** listos para usar
- **Gratuitos** - Sin costo de uso
- **Compartibles** - Otros pueden usar tu modelo

### **AnalogÃ­a del Mercado de Aplicaciones**
- **App Store:** Donde descargas aplicaciones
- **Hugging Face Spaces:** Donde creas y compartes modelos de IA
- **Ventaja:** Gratuito y de cÃ³digo abierto

---

## ğŸš€ Ventajas de Hugging Face Spaces

### **âœ… Ventajas:**
- **Completamente gratuito** - Sin costo de uso
- **CÃ³digo abierto** - Transparencia total
- **Comunidad activa** - Mucha ayuda disponible
- **Modelos diversos** - Muchas opciones
- **FÃ¡cil de compartir** - Compartir con otros
- **Personalizable** - Puedes modificar cÃ³digo

### **âŒ Desventajas:**
- **Requiere algo de cÃ³digo** - No es 100% visual
- **Curva de aprendizaje** - MÃ¡s tÃ©cnico
- **Recursos limitados** - GPU compartida
- **Menos documentaciÃ³n** - Para principiantes

---

## ğŸ“‹ PreparaciÃ³n: Datos de Entrenamiento

### **Ejemplo: Clasificador de Sentimientos para Restaurante**

#### **Objetivo:**
Clasificar comentarios de clientes como:
- **Positivo** - Comentarios buenos
- **Negativo** - Comentarios malos
- **Neutral** - Comentarios neutros

#### **Datos de entrenamiento (formato CSV):**

```csv
text,label
"La comida estuvo deliciosa y el servicio excelente",positivo
"El plato llegÃ³ frÃ­o y tardÃ³ mucho en llegar",negativo
"El restaurante estÃ¡ bien ubicado",neutral
"Excelente atenciÃ³n al cliente, muy recomendable",positivo
"La comida no me gustÃ³ para nada",negativo
"El lugar estÃ¡ limpio y organizado",neutral
"El mejor restaurante de la ciudad, volverÃ© seguro",positivo
"PÃ©simo servicio, nunca mÃ¡s vuelvo",negativo
"El precio estÃ¡ bien para la calidad",neutral
"La comida es buena pero el servicio es lento",negativo
"Ambiente agradable y comida casera",positivo
"El restaurante estÃ¡ cerrado los lunes",neutral
```

---

## ğŸ”§ Paso a Paso: Crear Space en Hugging Face

### **Paso 1: Crear Cuenta y Acceder**
1. Ve a [huggingface.co](https://huggingface.co)
2. Haz clic en "Sign up"
3. Completa el registro
4. Verifica tu email
5. En el menÃº principal, haz clic en "Spaces"
6. Haz clic en "Create new Space"

### **Paso 2: Configurar el Space**
- **Nombre:** `restaurant-sentiment-classifier`
- **DescripciÃ³n:** "Clasificador de sentimientos para comentarios de restaurante"
- **Licencia:** MIT
- **Visibilidad:** PÃºblico
1. Busca "fine-tuning" en los templates
2. Selecciona "Text Classification Fine-tuning"
3. Haz clic en "Use this template"

### **Paso 3: Subir Datos de Entrenamiento**
1. Crea un archivo llamado `train.csv`
2. Copia los datos de entrenamiento
3. En tu Space, haz clic en "Files"
4. Haz clic en "Add file" â†’ "Upload file"
5. Selecciona tu archivo `train.csv`
6. Haz clic en "Commit changes"

### **Paso 4: Configurar el Entrenamiento**
1. Ve a "Files" â†’ "app.py"
2. Busca la secciÃ³n de configuraciÃ³n
3. Modifica los parÃ¡metros segÃºn necesites:

```python
# ConfiguraciÃ³n del modelo
model_name = "distilbert-base-uncased"
num_labels = 3  # positivo, negativo, neutral
max_length = 128
batch_size = 16
epochs = 3
learning_rate = 2e-5
```

### **Paso 5: Iniciar Entrenamiento**
1. Ve a la pestaÃ±a "App"
2. Haz clic en "Run this Space"
3. El entrenamiento comenzarÃ¡ automÃ¡ticamente
4. Monitorea el progreso (10-30 minutos)

---

## ğŸ§ª Paso a Paso: Probar el Modelo

### **Paso 1: Acceder al Modelo Entrenado**
1. Ve a la pestaÃ±a "App"
2. VerÃ¡s la interfaz del clasificador
3. El modelo estarÃ¡ listo para usar

### **Paso 2: Probar con Comentarios**
- **Campo de texto** - Para escribir comentarios
- **BotÃ³n "Classify"** - Para clasificar
- **Resultado** - Muestra la clasificaciÃ³n

#### **Comentarios positivos:**
```
Comentario: "La comida estuvo deliciosa y el servicio excelente"
Resultado esperado: Positivo (95% confianza)
```

#### **Comentarios negativos:**
```
Comentario: "El plato llegÃ³ frÃ­o y tardÃ³ mucho en llegar"
Resultado esperado: Negativo (90% confianza)
```

#### **Comentarios neutros:**
```
Comentario: "El restaurante estÃ¡ bien ubicado"
Resultado esperado: Neutral (85% confianza)
```

### **Paso 3: Evaluar Resultados**
- **Comentarios positivos** â†’ Clasificados como positivos
- **Comentarios negativos** â†’ Clasificados como negativos
- **Comentarios neutros** â†’ Clasificados como neutros

---

## ğŸ“Š Resultados Esperados

### **Antes del Fine-tuning (Modelo General):**
- **Comentario:** "La comida estuvo deliciosa"
- **Resultado:** Positivo (60% confianza)

### **DespuÃ©s del Fine-tuning (Modelo Personalizado):**
- **Comentario:** "La comida estuvo deliciosa"
- **Resultado:** Positivo (95% confianza)

### **Mejoras Obtenidas:**
- âœ… **Mayor precisiÃ³n** - Mejor clasificaciÃ³n
- âœ… **Mayor confianza** - Modelo mÃ¡s seguro
- âœ… **Mejor comprensiÃ³n** - Entiende el contexto del restaurante
- âœ… **ClasificaciÃ³n especÃ­fica** - Adaptado a tu dominio

---

## ğŸ” Casos de Prueba

### **Caso 1: Comentario Positivo**
```
Comentario: "Excelente atenciÃ³n al cliente, muy recomendable"
Resultado esperado: Positivo (95% confianza)
```

### **Caso 2: Comentario Negativo**
```
Comentario: "PÃ©simo servicio, nunca mÃ¡s vuelvo"
Resultado esperado: Negativo (98% confianza)
```

### **Caso 3: Comentario Neutral**
```
Comentario: "El precio estÃ¡ bien para la calidad"
Resultado esperado: Neutral (85% confianza)
```

### **Caso 4: Comentario Ambiguo**
```
Comentario: "La comida es buena pero el servicio es lento"
Resultado esperado: Negativo (70% confianza)
```

### **Caso 5: Comentario Complejo**
```
Comentario: "El mejor restaurante de la ciudad, volverÃ© seguro"
Resultado esperado: Positivo (90% confianza)
```

---

## âš ï¸ SoluciÃ³n de Problemas Comunes

### **Problema 1: Error al subir archivo**
- **Causa:** Formato incorrecto del CSV
- **SoluciÃ³n:** Verificar que el CSV tenga las columnas correctas
- **PrevenciÃ³n:** Usar un validador CSV online

### **Problema 2: Entrenamiento falla**
- **Causa:** Datos insuficientes o de mala calidad
- **SoluciÃ³n:** Revisar y mejorar los datos
- **PrevenciÃ³n:** Validar datos antes de subir

### **Problema 3: Modelo no clasifica bien**
- **Causa:** Datos inconsistentes o insuficientes
- **SoluciÃ³n:** Agregar mÃ¡s ejemplos de calidad
- **PrevenciÃ³n:** Revisar datos antes del entrenamiento

### **Problema 4: Space no se ejecuta**
- **Causa:** Error en el cÃ³digo o configuraciÃ³n
- **SoluciÃ³n:** Revisar logs y corregir errores
- **PrevenciÃ³n:** Probar cÃ³digo localmente primero

---

## ğŸ“ˆ MÃ©tricas de Ã‰xito

### **MÃ©tricas Cuantitativas:**
- **PrecisiÃ³n:** % de clasificaciones correctas
- **Recall:** % de casos positivos detectados
- **F1-Score:** Balance entre precisiÃ³n y recall
- **Confianza:** Nivel de seguridad del modelo

### **MÃ©tricas Cualitativas:**
- **ComprensiÃ³n:** Â¿Entiende el contexto del restaurante?
- **Consistencia:** Â¿Clasifica similarmente casos similares?
- **Robustez:** Â¿Maneja casos ambiguos bien?
- **Utilidad:** Â¿Es Ãºtil para el negocio?

---

## ğŸ’¡ Consejos para el Ã‰xito

### **1. Calidad de Datos:**
- **Mejor pocos buenos** que muchos regulares
- **Consistencia** en las etiquetas
- **Ejemplos representativos** del dominio

### **2. IteraciÃ³n Continua:**
- **Probar** con casos reales
- **Mejorar** basado en resultados
- **Iterar** constantemente

### **3. Monitoreo:**
- **Revisar** clasificaciones regularmente
- **Identificar** problemas temprano
- **Ajustar** segÃºn sea necesario

### **4. Compartir:**
- **Documentar** tu proceso
- **Compartir** con la comunidad
- **Aprender** de otros

---

## ğŸ”— Compartir tu Modelo

### **Paso 1: Hacer PÃºblico**
1. Ve a "Settings" en tu Space
2. Cambia la visibilidad a "Public"
3. Agrega una descripciÃ³n detallada
4. Incluye ejemplos de uso

### **Paso 2: Documentar**
1. Crea un README.md
2. Explica cÃ³mo usar el modelo
3. Incluye ejemplos de cÃ³digo
4. Documenta limitaciones

### **Paso 3: Promocionar**
1. Comparte en redes sociales
2. Publica en foros de IA
3. Participa en la comunidad
4. Pide feedback

---

## ğŸ“Š ComparaciÃ³n: OpenAI vs Hugging Face

| CaracterÃ­stica | OpenAI | Hugging Face |
|----------------|--------|--------------|
| **Facilidad** | â­â­â­â­â­ | â­â­â­ |
| **Costo** | ğŸ’°ğŸ’°ğŸ’° | ğŸ†“ |
| **ProgramaciÃ³n** | No | SÃ­ |
| **Recursos** | Alto | Medio |
| **Comunidad** | Grande | Muy Grande |
| **PersonalizaciÃ³n** | Limitada | Alta |
| **Compartir** | DifÃ­cil | FÃ¡cil |

---

## ğŸ“ Resumen de Conceptos Clave

### **Proceso completo:**
1. **Crear Space** - En Hugging Face
2. **Subir datos** - Formato CSV correcto
3. **Configurar entrenamiento** - ParÃ¡metros del modelo
4. **Entrenar modelo** - Proceso automÃ¡tico
5. **Probar resultados** - Con casos reales
6. **Compartir modelo** - Con la comunidad

### **Factores de Ã©xito:**
- âœ… **Datos de calidad** - Consistentes y etiquetados
- âœ… **Cantidad suficiente** - Al menos 20-50 ejemplos
- âœ… **Casos representativos** - Cubrir situaciones reales
- âœ… **IteraciÃ³n continua** - Mejorar constantemente

### **Errores a evitar:**
- âŒ **Datos inconsistentes** - Etiquetas incorrectas
- âŒ **InformaciÃ³n incorrecta** - Datos desactualizados
- âŒ **Pocos ejemplos** - Menos de 10-20
- âŒ **No probar** - Desplegar sin validar

---

---

# 2.6 Fine-Tuning para ImÃ¡genes

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Entender el concepto de transfer learning en imÃ¡genes
- Aplicar fine-tuning a modelos de clasificaciÃ³n de imÃ¡genes
- Implementar el proceso de dos etapas (clasificador + red completa)
- Adaptar modelos pre-entrenados a nuevas clases con pocos datos

---

## ğŸ–¼ï¸ IntroducciÃ³n al Fine-Tuning de ImÃ¡genes

### **Â¿QuÃ© es el Fine-Tuning de ImÃ¡genes?**
- **Transfer Learning** - Usar un modelo pre-entrenado como base
- **AdaptaciÃ³n** - Modificar el modelo para nuevas clases
- **Pocos datos** - Funciona con menos imÃ¡genes que entrenar desde cero
- **Mejor rendimiento** - Aprovecha conocimiento previo del modelo

### **AnalogÃ­a: Aprender un Nuevo Idioma**
- **Modelo pre-entrenado:** Como saber espaÃ±ol
- **Fine-tuning:** Como aprender italiano (similar al espaÃ±ol)
- **Entrenar desde cero:** Como aprender chino (desde cero)
- **Resultado:** Aprendes italiano mÃ¡s rÃ¡pido que chino

---

## ğŸ§  Arquitectura de CNN: Dos Partes Principales

### **El fine-tuning para imÃ¡genes se hace en 2 partes principales:**

#### **1. ExtracciÃ³n de CaracterÃ­sticas (Capas Convolucionales)**
- **FunciÃ³n:** Detectar patrones y caracterÃ­sticas visuales
- **Capas:** Convolucionales, pooling, activaciÃ³n
- **Resultado:** Mapas de caracterÃ­sticas (features)
- **AnalogÃ­a:** Como los "ojos" que ven formas, bordes, texturas

#### **2. ClasificaciÃ³n de CaracterÃ­sticas (Capas Densas)**
- **FunciÃ³n:** Tomar decisiones basadas en las caracterÃ­sticas
- **Capas:** Fully connected, dense layers
- **Resultado:** Probabilidades de cada clase
- **AnalogÃ­a:** Como el "cerebro" que interpreta lo que ven los ojos

### **ğŸ” VisualizaciÃ³n Interactiva de CNN**

Para entender mejor cÃ³mo funcionan las redes neuronales convolucionales, puedes explorar estas visualizaciones interactivas:

- **VisualizaciÃ³n 2D:** [https://adamharley.com/nn_vis/cnn/2d.html](https://adamharley.com/nn_vis/cnn/2d.html)
- **VisualizaciÃ³n 3D:** [https://adamharley.com/nn_vis/cnn/3d.html](https://adamharley.com/nn_vis/cnn/3d.html)

Estas herramientas te permiten:
- **Dibujar nÃºmeros** y ver cÃ³mo la red los procesa
- **Observar cada capa** de la red neuronal
- **Entender el flujo** desde imagen hasta predicciÃ³n
- **Ver los filtros** en acciÃ³n paso a paso

---

## ğŸ”§ Proceso de Fine-Tuning en Dos Etapas

### **Etapa 1: Reemplazar Clasificador**
#### **Â¿QuÃ© hacemos?**
1. **Cargar modelo grande** - ResNet, VGG, EfficientNet, etc.
2. **Congelar convolucionales** - Mantener caracterÃ­sticas aprendidas
3. **Reemplazar clasificador** - Nueva capa para nuestras clases
4. **Entrenar solo clasificador** - RÃ¡pido y eficiente

#### **Ventajas:**
- âœ… **RÃ¡pido** - Solo entrenamos la Ãºltima capa
- âœ… **Eficiente** - Pocos parÃ¡metros a ajustar
- âœ… **Estable** - CaracterÃ­sticas base no cambian
- âœ… **Pocos datos** - Funciona con 100-1000 imÃ¡genes

### **Etapa 2: Entrenar Toda la Red**
#### **Â¿QuÃ© hacemos?**
1. **Descongelar toda la red** - Permitir ajustes finos
2. **Learning rate bajo** - Ajustes sutiles
3. **Entrenamiento completo** - Mejora adicional
4. **ValidaciÃ³n cuidadosa** - Evitar overfitting

#### **Ventajas:**
- âœ… **Mejor rendimiento** - OptimizaciÃ³n completa
- âœ… **AdaptaciÃ³n fina** - Ajustes especÃ­ficos al dominio
- âœ… **MÃ¡xima precisiÃ³n** - Aprovecha todo el modelo

---

## ğŸ“Š Ejemplo PrÃ¡ctico: Clasificador de Gatos y Perros

### **Caso de Uso: Identificar Gatos vs Perros**
- **Clases:** Gato, Perro
- **Datos:** 1000 imÃ¡genes por clase (2000 total)
- **Modelo base:** MobileNetV2 pre-entrenado en ImageNet
- **Objetivo:** Clasificar correctamente las 2 clases

**ğŸ”— Tutorial completo:** [TensorFlow Transfer Learning](https://www.tensorflow.org/tutorials/images/transfer_learning)

### **Estructura de Datos:**
```
Dataset/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ cats/
â”‚   â””â”€â”€ dogs/
â””â”€â”€ validation/
    â”œâ”€â”€ cats/
    â””â”€â”€ dogs/
```

---

## ğŸ”§ ImplementaciÃ³n con TensorFlow

### **Paso 1: Cargar Modelo Pre-entrenado**
```python
import tensorflow as tf
from tensorflow import keras

# Cargar MobileNetV2 pre-entrenado
base_model = keras.applications.MobileNetV2(
    input_shape=(160, 160, 3),
    include_top=False,
    weights='imagenet'
)

# Congelar capas base
base_model.trainable = False
```

### **Paso 2: Agregar Clasificador**
```python
# Agregar capas de clasificaciÃ³n
model = keras.Sequential([
    base_model,
    keras.layers.GlobalAveragePooling2D(),
    keras.layers.Dense(1, activation='sigmoid')
])

model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.0001),
    loss='binary_crossentropy',
    metrics=['accuracy']
)
```

### **Paso 3: Etapa 1 - Entrenar Solo Clasificador**
```python
# Entrenar solo las capas nuevas
initial_epochs = 10
history = model.fit(train_dataset, epochs=initial_epochs, 
                   validation_data=validation_dataset)
```

### **Paso 4: Etapa 2 - Fine-tuning Completo**
```python
# Descongelar capas base
base_model.trainable = True

# Ajustar learning rate mÃ¡s bajo
model.compile(
    optimizer=keras.optimizers.Adam(learning_rate=0.0001/10),
    loss='binary_crossentropy',
    metrics=['accuracy']
)

# Fine-tuning completo
fine_tune_epochs = 10
total_epochs = initial_epochs + fine_tune_epochs

history_fine = model.fit(train_dataset, epochs=total_epochs,
                        initial_epoch=history.epoch[-1],
                        validation_data=validation_dataset)
```

---

## ğŸ“ˆ Resultados del Tutorial

### **Etapa 1: Feature Extraction**
- **PrecisiÃ³n:** ~97% en validaciÃ³n
- **Tiempo:** 10 Ã©pocas rÃ¡pidas
- **Estado:** Base congelada

### **Etapa 2: Fine-tuning**
- **PrecisiÃ³n final:** ~98% en validaciÃ³n
- **Mejora:** +1% adicional
- **Tiempo:** 10 Ã©pocas adicionales

### **Resultado Final:**
- **Test accuracy:** 96.8%
- **MÃ©todo:** MobileNetV2 + fine-tuning
- **Datos:** ~2000 imÃ¡genes gatos/perros

---

## ğŸ” Casos de Prueba

### **PredicciÃ³n en Lote:**
```python
# Obtener batch de imÃ¡genes de prueba
image_batch, label_batch = test_dataset.as_numpy_iterator().next()
predictions = model.predict_on_batch(image_batch).flatten()
predictions = tf.where(predictions < 0.5, 0, 1)

# Resultado: 96.8% accuracy en test set
```

### **Casos TÃ­picos:**
- **Gatos claros:** 95%+ confianza
- **Perros claros:** 95%+ confianza  
- **ImÃ¡genes ambiguas:** 70-90% confianza
- **Casos difÃ­ciles:** 60-80% confianza

---

## âš ï¸ Puntos Clave

### **Overfitting:**
- **SÃ­ntoma:** Validation loss > Training loss
- **SoluciÃ³n:** Data augmentation, menos Ã©pocas

### **Learning Rate:**
- **Clasificador:** 0.0001 (normal)
- **Fine-tuning:** 0.00001 (10x menor)

### **Datos:**
- **MÃ­nimo:** 100 imÃ¡genes por clase
- **Recomendado:** 1000+ por clase
- **Balance:** Mismo nÃºmero de ejemplos por clase

---

## ğŸ“ Resumen

### **Proceso:**
1. **Feature Extraction:** Congelar base, entrenar clasificador
2. **Fine-tuning:** Descongelar base, learning rate bajo
3. **Resultado:** 96.8% accuracy con 2000 imÃ¡genes

### **Ventajas:**
- âœ… **RÃ¡pido:** 20 Ã©pocas vs 100+ desde cero
- âœ… **Eficiente:** Menos datos necesarios
- âœ… **Preciso:** Mejor rendimiento que entrenar desde cero

### **Requisitos:**
- âœ… **Modelo pre-entrenado:** MobileNetV2, ResNet, etc.
- âœ… **Datos balanceados:** Mismo nÃºmero por clase
- âœ… **Learning rate:** 10x menor para fine-tuning

---

# 2.7 Ejemplo con LangChain y Hugging Face

## ğŸ¯ Objetivos de esta SecciÃ³n

Al finalizar esta secciÃ³n, los participantes podrÃ¡n:
- Integrar modelos de Hugging Face con LangChain
- Crear aplicaciones de IA usando componentes modulares
- Implementar pipelines de procesamiento de texto
- Desplegar soluciones usando ambas plataformas

---

## ğŸ”— LangChain + Hugging Face

### **LangChain:**
- **Framework** para aplicaciones de IA
- **Componentes modulares** - Construir apps complejas
- **IntegraciÃ³n fÃ¡cil** - Conectar servicios

### **Ejemplo: Chatbot con RAG**
- **Caso:** Asistente de ventas con catÃ¡logo de productos
- **Modelo:** Hugging Face (DialoGPT)
- **FunciÃ³n:** Responder preguntas sobre productos

### **Arquitectura:**
```
Usuario â†’ LangChain â†’ HF Model â†’ Base Conocimiento â†’ Respuesta
```

---

## ğŸ”§ ImplementaciÃ³n

### **1. Instalar Dependencias**
```bash
pip install langchain transformers torch sentence-transformers chromadb streamlit
```

### **2. Configurar Modelo**
```python
from langchain.llms import HuggingFacePipeline
from transformers import pipeline

# Cargar modelo Hugging Face
hf_pipeline = pipeline("text-generation", 
                      model="microsoft/DialoGPT-medium")

# Integrar con LangChain
llm = HuggingFacePipeline(pipeline=hf_pipeline)
```

### **3. Base de Conocimiento**
```python
from langchain.vectorstores import Chroma
from langchain.embeddings import HuggingFaceEmbeddings

# Documentos de productos
docs = [
    "iPhone 15: 6.1 pulgadas, 48MP cÃ¡mara, A17 Pro",
    "MacBook Pro M2: 16GB RAM, 512GB SSD, 14 pulgadas"
]

# Crear embeddings y base vectorial
embeddings = HuggingFaceEmbeddings(model_name="all-MiniLM-L6-v2")
vectorstore = Chroma.from_texts(docs, embeddings)
```

### **4. Chain de RAG**
```python
from langchain.chains import RetrievalQA

# Crear chain pregunta-respuesta
qa_chain = RetrievalQA.from_chain_type(
    llm=llm,
    retriever=vectorstore.as_retriever()
)
```

### **5. Interfaz Streamlit**
```python
import streamlit as st

st.title("ğŸ¤– Asistente de Ventas")
question = st.text_input("Â¿QuÃ© te gustarÃ­a saber?")

if question:
    answer = qa_chain({"query": question})
    st.write(answer["result"])
```

---

## ğŸ§ª Casos de Prueba

### **Ejemplos:**
- **"Â¿QuÃ© caracterÃ­sticas tiene el iPhone 15?"** â†’ Info pantalla, cÃ¡mara, procesador
- **"Â¿CuÃ¡nta RAM tiene la MacBook Pro?"** â†’ "16GB de RAM"
- **"Â¿QuÃ© accesorios tienen cancelaciÃ³n de ruido?"** â†’ Info AirPods Pro

---

## ğŸ“Š Resultados

### **Funcionalidades:**
- âœ… **BÃºsqueda semÃ¡ntica** - Encuentra info relevante
- âœ… **Respuestas contextuales** - Basadas en conocimiento
- âœ… **Interfaz amigable** - FÃ¡cil de usar
- âœ… **Escalable** - Agregar mÃ¡s productos fÃ¡cil

### **Ventajas:**
- âœ… **Modular** - Componentes independientes
- âœ… **Flexible** - Cambiar modelos fÃ¡cil
- âœ… **Mantenible** - CÃ³digo organizado

---

## ğŸ“ Resumen

### **LangChain + Hugging Face:**
- **LangChain:** Orquesta componentes
- **Hugging Face:** Modelos pre-entrenados
- **Resultado:** Apps modulares y escalables

### **Casos de uso:**
- **Chatbots** con base de conocimiento
- **Asistentes virtuales** empresariales
- **Sistemas Q&A** para documentaciÃ³n

---

*Este material estÃ¡ diseÃ±ado para ser accesible y comprensible para personas sin conocimientos tÃ©cnicos avanzados. Las analogÃ­as y ejemplos ayudan a entender conceptos complejos de manera simple.*
